(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[    115612,       2892]
NotebookOptionsPosition[    110183,       2807]
NotebookOutlinePosition[    110599,       2824]
CellTagsIndexPosition[    110556,       2821]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"(*", " ", 
    RowBox[{"Set", " ", "Up", " ", "Computer", " ", "Options"}], " ", "*)"}], 
   "Chapter"], 
  StyleBox[" ", "Chapter"], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SetDirectory", "[", 
     RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CreateDirectory", "[", "\"\<results_amolf\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Set", " ", "Up", " ", "Computer", " ", "Options"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"numkernel", "=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Unprotect", "[", "$ProcessorCount", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"$ProcessorCount", "=", "numkernel"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"$HistoryLength", "=", "0"}]}]}]], "Code",
 InitializationCell->False,
 CellChangeTimes->{{3.805267799485217*^9, 3.805267804176828*^9}, {
   3.80526789146805*^9, 3.805267900119212*^9}, 3.80526984585115*^9, {
   3.8172943232402353`*^9, 3.817294325039092*^9}, {3.8190210190945044`*^9, 
   3.819021020692421*^9}, {3.819021075888667*^9, 3.8190210763978643`*^9}, 
   3.8205824192235813`*^9, {3.822131849811967*^9, 3.822131851874803*^9}, {
   3.8705971069269457`*^9, 3.870597115601264*^9}, {3.8708777856746817`*^9, 
   3.870877798100143*^9}},
 CellLabel->
  "In[1389]:=",ExpressionUUID->"e1ccfd5e-5827-4fc6-b53b-90d42af0aee2"],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8732247385971746`*^9, 
  3.873224750497301*^9}},ExpressionUUID->"22ca08d9-1cb1-4de2-aaf6-\
ee0c5a7b543c"],

Cell[BoxData["\<\"/Users/tomikbaikie/Dropbox (Cambridge \
University)/Physics/SimulationsLSC/Example_simulation/lumogen/Raytracing\"\>"]\
, "Output",
 CellChangeTimes->{
  3.870961926802175*^9, 3.870969360193462*^9, 3.873173034734581*^9, {
   3.873224735845359*^9, 3.873224743741856*^9}},
 CellLabel->
  "Out[1395]=",ExpressionUUID->"07208e8c-7639-42ee-84d5-ad0f7bad33a3"]
}, Open  ]],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"(*", " ", 
    RowBox[{"Set", " ", "Up", " ", "Raytracing", " ", "Options"}], " ", 
    "*)"}], " "}], "Chapter"]], "Input",
 CellChangeTimes->{{3.805270051748287*^9, 3.805270052771349*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"c6084de3-b099-4537-b9df-fcfb1e880688"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sides", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"anglestart", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"angleend", "=", "90"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"numberofphotons", "=", "10000"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numberofangles", "=", "89"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"totalphotonsin", "=", "numberofphotons"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cell", "=", "13"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.805357862920857*^9, 3.8053578787374763`*^9}, {
   3.817294327300723*^9, 3.8172943275560427`*^9}, {3.823342140429227*^9, 
   3.8233421416329737`*^9}, {3.870615047709579*^9, 3.870615047992318*^9}, 
   3.8709619308771753`*^9},
 CellLabel->
  "In[1396]:=",ExpressionUUID->"43462baf-1c9b-42b7-8f71-e97b77586197"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"(*", " ", 
    RowBox[{"Set", " ", "Up", " ", "Simulation", " ", "Options"}], " ", 
    "*)"}], " "}], "Chapter"]], "Input",
 Evaluatable->False,
 CellChangeTimes->{{3.798552051791057*^9, 3.798552052637073*^9}, 
   3.798552148183519*^9, {3.799005681144649*^9, 3.7990056838655148`*^9}, {
   3.805267822255885*^9, 
   3.805267835633246*^9}},ExpressionUUID->"d3025d4b-3951-4e00-bee5-\
185e79cdbba2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"-", " ", "Notebook"}]}]}], " ", "Running", " ", 
     RowBox[{
      RowBox[{"Running", " ", "--"}], "--"}]}], "-"}], " ", "*)"}], " ", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"dayinyear", "=", 
     RowBox[{"ToExpression", "[", "70", "]"}]}], ";", "\n", 
    RowBox[{"startwavelength", "=", 
     RowBox[{"ToExpression", "[", "320", "]"}]}], ";", "\n", 
    RowBox[{"endwavelength", "=", 
     RowBox[{"ToExpression", "[", "550", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"timestepsize", "=", "60"}], ";", "\[IndentingNewLine]", 
    RowBox[{"days", "=", "100"}], ";"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"LSC", " ", "orientation"}], ";", " ", 
    RowBox[{
    "vector", " ", "defining", " ", "its", " ", "surface", " ", "normal", " ",
      "in", " ", "degrees"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"lscAltitude", "=", "0"}], " ", ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"0", " ", "is", " ", "horizontal"}], ",", " ", 
     RowBox[{"90", " ", "is", " ", "vertical", " ", "up"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lscAzimuth", " ", "=", " ", "180"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"0", " ", "is", " ", "facing", " ", "North"}], ",", " ", 
     RowBox[{"180", " ", "is", " ", "facing", " ", "South"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearSystemCache", "[", "]"}], ";"}], " ", "\[IndentingNewLine]",
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"-", " ", "Command"}]}]}], " ", "Line", " ", 
      RowBox[{
       RowBox[{"Running", " ", "--"}], "--"}]}], "-"}], " ", "*)"}], " ", 
   "\n", 
   RowBox[{
    RowBox[{"cmddata", "=", "$ScriptCommandLine"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"days", "=", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"cmddata", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.805267905789054*^9, 3.805267931436739*^9}, {
   3.8053468572949605`*^9, 3.8053468708011885`*^9}, 3.805347715662607*^9, {
   3.805347758281267*^9, 3.805347759992433*^9}, {3.805357727313504*^9, 
   3.805357734555811*^9}, {3.8053578693896837`*^9, 3.805357874081431*^9}, {
   3.805364675131206*^9, 3.805364678467602*^9}, {3.805366789918928*^9, 
   3.8053667953952427`*^9}, {3.805460809692504*^9, 3.80546081631047*^9}, {
   3.8084699358422623`*^9, 3.80846998766193*^9}, {3.808473614363312*^9, 
   3.8084736145516853`*^9}, {3.808473968931185*^9, 3.808473970857449*^9}, {
   3.808474231631983*^9, 3.80847423174319*^9}, {3.808549603511387*^9, 
   3.808549734928071*^9}, {3.808550222169393*^9, 3.808550225863323*^9}, {
   3.808550739966363*^9, 3.808550740078639*^9}, 3.8085568451922092`*^9, {
   3.80855962025005*^9, 3.80855962032484*^9}, {3.820671996136916*^9, 
   3.820672033213348*^9}, {3.8705907541926813`*^9, 3.8705907566920137`*^9}, {
   3.870874261294963*^9, 3.8708742710827217`*^9}, {3.870961965646134*^9, 
   3.87096199237988*^9}},
 CellLabel->
  "In[1403]:=",ExpressionUUID->"94fd9888-9688-4021-a4b9-f173e1fe4269"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"(*", " ", 
    RowBox[{
    "Import", " ", "or", " ", "Create", " ", "Raytracing", " ", "Results"}], 
    " ", "*)"}], " "}], "Chapter"]], "Input",
 Evaluatable->False,
 CellChangeTimes->{{3.798552051791057*^9, 3.798552052637073*^9}, 
   3.798552148183519*^9, {3.799005681144649*^9, 3.7990056838655148`*^9}, {
   3.805267822255885*^9, 3.805267835633246*^9}, {3.805267977383191*^9, 
   3.805268001323687*^9}},ExpressionUUID->"eff5ed55-8f92-4d10-b4ef-\
af36e67586c6"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"(*", " ", 
    RowBox[{"Raytracing", " ", "Data"}], " ", "*)"}], " "}], 
  "Chapter"]], "Input",
 Evaluatable->False,
 CellChangeTimes->{{3.798552051791057*^9, 3.798552052637073*^9}, 
   3.798552148183519*^9, {3.799005681144649*^9, 3.7990056838655148`*^9}, {
   3.805267822255885*^9, 3.805267835633246*^9}, {3.805267977383191*^9, 
   3.805268001323687*^9}, {3.805268467886704*^9, 3.805268469507244*^9}, {
   3.8707036948430443`*^9, 
   3.8707036958637466`*^9}},ExpressionUUID->"f96a784c-24d0-4e8d-9c17-\
5174a10f4532"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"import", " ", "datastore"}], " ", "*)"}], " ", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Import", "[", "\"\<./raytracingdata.mx\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "minimumwavelength", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"emissionmax", "=", 
     RowBox[{"N", "[", "1200", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"emissionmin", "=", 
     RowBox[{"N", "[", "311", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"wavelengthtable", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"N", "[", "x", "]"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "emissionmin", ",", "emissionmax", ",", "1"}], 
        "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.805268623831862*^9, 3.805268635418723*^9}, {
   3.80526931327194*^9, 3.805269322460699*^9}, {3.8052758915992727`*^9, 
   3.8052759008036127`*^9}, {3.805276069282549*^9, 3.8052760708394957`*^9}, 
   3.80534772297127*^9, 3.805464717145083*^9, {3.805464748495162*^9, 
   3.805464752497604*^9}, 3.808474259722783*^9, {3.8706173210258293`*^9, 
   3.8706174430303993`*^9}, {3.870617479488431*^9, 3.870617514720518*^9}, {
   3.8706175494320993`*^9, 3.870617557181986*^9}, {3.870703704315196*^9, 
   3.870703712772129*^9}, {3.8707037454578733`*^9, 3.87070374755009*^9}, {
   3.870703866027631*^9, 3.870703873854899*^9}, {3.8708636884920263`*^9, 
   3.870863696107779*^9}, {3.8709624332768784`*^9, 3.870962505466221*^9}, 
   3.870962549607692*^9, {3.870962623301961*^9, 3.870962625089658*^9}, 
   3.8709626867557287`*^9, {3.8709693831660223`*^9, 3.8709693835157127`*^9}},
 CellLabel->
  "In[1409]:=",ExpressionUUID->"6edd1b18-3690-4b26-a3c0-f03267a18b57"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "raytracingdata", "]"}]], "Input",
 CellChangeTimes->{{3.870969388816519*^9, 3.870969391385066*^9}},
 CellLabel->
  "In[1413]:=",ExpressionUUID->"c124b16d-2a10-4cc5-8638-a632d58d2367"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4", ",", "90", ",", "890"}], "}"}]], "Output",
 CellChangeTimes->{3.870969391823722*^9, 3.873173073385146*^9, 
  3.873224765250499*^9},
 CellLabel->
  "Out[1413]=",ExpressionUUID->"a6fbf560-9cf5-4e9d-abdc-4fff7ff70cef"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.870962586370413*^9, 
  3.870962620088025*^9}},ExpressionUUID->"60771c55-47d6-4966-ae35-\
f4113a2030fb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"daysinmonth", " ", "=", 
     RowBox[{"{", 
      RowBox[{
      "31", ",", "28", ",", "31", ",", "16", ",", "31", ",", "30", ",", "31", 
       ",", "31", ",", "21", ",", "31", ",", "30", ",", "31"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{"1", "<=", "days", "<=", 
       RowBox[{"Total", "[", 
        RowBox[{"daysinmonth", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<jan\>\"", "]"}], ";", 
       RowBox[{"monthvalue", "=", "1"}], ";"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{"daysinmonth", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", "days", "<=", 
       RowBox[{"Total", "[", 
        RowBox[{"daysinmonth", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "2"}], "]"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<feb\>\"", "]"}], ";", 
       RowBox[{"monthvalue", "=", "2"}], ";"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{"daysinmonth", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "2"}], "]"}], "]"}], "]"}], "<", "days", "<=", 
       RowBox[{"Total", "[", 
        RowBox[{"daysinmonth", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "3"}], "]"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<march\>\"", "]"}], ";", 
       RowBox[{"monthvalue", "=", "3"}], ";"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{"daysinmonth", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "3"}], "]"}], "]"}], "]"}], "<", "days", "<=", 
       RowBox[{"Total", "[", 
        RowBox[{"daysinmonth", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "4"}], "]"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<apr\>\"", "]"}], ";", 
       RowBox[{"monthvalue", "=", "4"}], ";"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{"daysinmonth", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "4"}], "]"}], "]"}], "]"}], "<", "days", "<=", 
       RowBox[{"Total", "[", 
        RowBox[{"daysinmonth", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "5"}], "]"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<may\>\"", "]"}], ";", 
       RowBox[{"monthvalue", "=", "5"}], ";"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{"daysinmonth", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "5"}], "]"}], "]"}], "]"}], "<", "days", "<=", 
       RowBox[{"Total", "[", 
        RowBox[{"daysinmonth", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "6"}], "]"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<jun\>\"", "]"}], ";", 
       RowBox[{"monthvalue", "=", "6"}], ";"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{"daysinmonth", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "6"}], "]"}], "]"}], "]"}], "<", "days", "<=", 
       RowBox[{"Total", "[", 
        RowBox[{"daysinmonth", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "7"}], "]"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<july\>\"", "]"}], ";", 
       RowBox[{"monthvalue", "=", "7"}], ";"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{"daysinmonth", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "7"}], "]"}], "]"}], "]"}], "<", "days", "<=", 
       RowBox[{"Total", "[", 
        RowBox[{"daysinmonth", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "8"}], "]"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<aug\>\"", "]"}], ";", 
       RowBox[{"monthvalue", "=", "8"}], ";"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{"daysinmonth", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "8"}], "]"}], "]"}], "]"}], "<", "days", "<=", 
       RowBox[{"Total", "[", 
        RowBox[{"daysinmonth", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "9"}], "]"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<sept\>\"", "]"}], ";", " ", 
       RowBox[{"monthvalue", "=", "9"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{"daysinmonth", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "9"}], "]"}], "]"}], "]"}], "<", "days", "<=", 
       RowBox[{"Total", "[", 
        RowBox[{"daysinmonth", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "10"}], "]"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<oct\>\"", "]"}], ";", 
       RowBox[{"monthvalue", "=", "10"}], ";"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{"daysinmonth", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "10"}], "]"}], "]"}], "]"}], "<", "days", "<=", 
       RowBox[{"Total", "[", 
        RowBox[{"daysinmonth", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "11"}], "]"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<nov\>\"", "]"}], ";", 
       RowBox[{"monthvalue", "=", "11"}], ";"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{"daysinmonth", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "11"}], "]"}], "]"}], "]"}], "<", "days", "<=", 
       RowBox[{"Total", "[", 
        RowBox[{"daysinmonth", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "12"}], "]"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<dec\>\"", "]"}], ";", 
       RowBox[{"monthvalue", "=", "12"}], ";"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"daystartingpoint", " ", "=", " ", 
     RowBox[{"days", " ", "-", 
      RowBox[{"Total", "[", 
       RowBox[{"daysinmonth", "[", 
        RowBox[{"[", 
         RowBox[{";;", 
          RowBox[{"monthvalue", "-", "1"}]}], "]"}], "]"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"timepoint", " ", "=", " ", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"daystartingpoint", "-", "1"}], ")"}], "*", "8640"}]}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.870874253529389*^9, 3.870874275899576*^9}, 
   3.870962019353791*^9},
 CellLabel->
  "In[1414]:=",ExpressionUUID->"d809e300-63bf-4bb6-9df0-3e60669dd028"],

Cell[BoxData["\<\"jan\"\>"], "Print",
 CellChangeTimes->{{3.8709620124586277`*^9, 3.870962020503395*^9}, 
   3.873173076927224*^9, 3.87322476615187*^9},
 CellLabel->
  "During evaluation of \
In[1414]:=",ExpressionUUID->"e902c1e9-34ae-46cf-bab7-74c453cca7c6"]
}, Open  ]],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"(*", " ", 
    RowBox[{"Import", " ", "Spectra", " ", "Data"}], "  ", "*)"}], " "}], 
  "Chapter"]], "Input",
 CellChangeTimes->{{3.805268608854138*^9, 3.8052686106660233`*^9}, {
  3.805268670496414*^9, 3.8052686765704536`*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"f12be99d-d56b-4a4d-a005-309f597eb967"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Import", " ", "LAD", " ", "data", " ", "for", " ", "2019"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.819021361220104*^9, 3.819021370498741*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"dcf48d8e-17ff-4c52-8523-185241259ec0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LADData", "=", 
    RowBox[{"FileNames", "[", "\"\<./training_rules/*.mx\>\"", "]"}]}], ";"}],
   " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "All", " ", "LAD", " ", "data", " ", "for", " ", "2019.", " ", "One", " ",
      "file", " ", "for", " ", "each", " ", 
     RowBox[{"month", ".", " ", "Date"}], " ", "is", " ", "in", " ", 
     "absolute", " ", "time"}], ",", " ", 
    RowBox[{
    "the", " ", "twelve", " ", "following", " ", "numbers", " ", "are", " ", 
     "the", " ", "LAD", " ", 
     RowBox[{"sensors", ".", " ", "\n", "This"}], " ", "data", " ", "is", " ",
      "not", " ", "yet", " ", "calibrated", " ", "and", " ", "has", " ", "to",
      " ", "be", " ", "calibrated", " ", "with", " ", "the", " ", 
     "listCalibrate", " ", "function", " ", "below"}], ",", " ", 
    RowBox[{
    "since", " ", "the", " ", "neural", " ", "network", " ", "has", " ", 
     "been", " ", "trained", " ", "on", " ", "calibrated", " ", 
     RowBox[{"data", "."}]}]}], "*)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
   "Import", " ", "one", " ", "LAD", " ", "dataset", " ", "for", " ", "test", 
    " ", "purposes"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"monthdatalad", " ", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"LADData", "[", 
     RowBox[{"[", "monthvalue", "]"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"wavelengths", "=", 
    RowBox[{
    "Import", "[", "\"\<./machine_fluff/wavelengthsSpectrometer.mx\>\"", 
     "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"The", " ", "x"}], "-", 
    RowBox[{
    "Axis", " ", "for", " ", "the", " ", "result", " ", "of", " ", "the", " ",
      "training", " ", "network"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"trainedNet1", "=", 
    RowBox[{"Import", "[", "\"\<./machine_fluff/bestnet.wlnet\>\"", "]"}]}], 
   ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Import", " ", "the", " ", "best", " ", "training", " ", "network"}], ",",
     " ", 
    RowBox[{
    "trained", " ", "for", " ", "400", " ", "rounds", " ", "on", " ", "the", 
     " ", "year", " ", "2019.", " ", "\n", "The", " ", "neural", " ", "net", 
     " ", 
     RowBox[{"is", ":", " ", "Input"}]}], ",", " ", "Linearlayer5", ",", " ", 
    "ConstantLayer", ",", " ", 
    RowBox[{"Linearlayer", " ", "2048"}], ",", " ", "Abs", ",", " ", 
    RowBox[{
     RowBox[{"Output", ".", " ", "Please"}], " ", "see", " ", "training", " ",
      "notebook", " ", "and", " ", "powerpoint", " ", "presentation", " ", 
     "for", " ", 
     RowBox[{"details", "."}]}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"calibrationImport", "=", 
    RowBox[{
    "Import", "[", "\"\<./machine_fluff/calibrationTable.mx\>\"", "]"}]}], 
   ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Calibration", " ", "of", " ", "the", " ", "LAD", " ", "sensor", " ", 
     "data", " ", "to", " ", 
     RowBox[{"W", "/", 
      RowBox[{"m", "^", "2."}]}], " ", "Calibrated", " ", "with", " ", "a", 
     " ", "solar", " ", "simulator", " ", "at", " ", "amolf", " ", "by", " ", 
     "bachelor", " ", "student", " ", 
     RowBox[{"A", ".", "Pollastri", ".", " ", "\n", "The"}], " ", "solar", 
     " ", "simulator", " ", "is", " ", "set", " ", "to", " ", "different", 
     " ", "intensities", " ", "and", " ", "the", " ", "12", " ", "sensors", 
     " ", "held", " ", "at", " ", "different", " ", "temperatures"}], ",", 
    " ", 
    RowBox[{"such", " ", "that"}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SensorToWm2", "[", 
    RowBox[{"sensorNr_", ",", "color_", ",", "sensor1_", ",", "temp1_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"calibrationImport", "[", 
      RowBox[{"[", 
       RowBox[{"sensorNr", ",", "color"}], "]"}], "]"}], "/.", 
     RowBox[{"sensor", "\[Rule]", "sensor1"}]}], "/.", 
    RowBox[{"temp", "\[Rule]", "temp1"}]}]}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "calibration", " ", "function", " ", "needs", " ", "the", " ",
      "sensor", " ", "Nr"}], ",", " ", 
    RowBox[{"color", " ", 
     RowBox[{"(", "rgbIR", ")"}]}], ",", " ", 
    RowBox[{"sensor", " ", "Color"}], ",", " ", 
    RowBox[{"and", " ", "temperature"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"listCalibrate", "[", 
     RowBox[{"list_", ",", "sensor_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"red", ",", "green", ",", "blue", ",", "IR", ",", "temp"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"red", ",", "green", ",", "blue", ",", "IR", ",", "temp"}], 
         "}"}], "=", "list"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"SensorToWm2", "[", 
          RowBox[{"sensor", ",", "1", ",", "red", ",", "temp"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"SensorToWm2", "[", 
          RowBox[{"sensor", ",", "2", ",", "green", ",", "temp"}], "]"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"SensorToWm2", "[", 
          RowBox[{"sensor", ",", "3", ",", "blue", ",", "temp"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"SensorToWm2", "[", 
          RowBox[{"sensor", ",", "4", ",", "IR", ",", "temp"}], "]"}], ",", 
         "\[IndentingNewLine]", "temp"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "see", " ", "additional", " ", "documentation", " ", "for", " ", "how", 
    " ", "anglular", " ", "dependence", " ", "from", " ", "the", " ", "LAD", 
    " ", "is", " ", "determined"}], " ", "*)"}], " ", "\n", 
  RowBox[{"(*", 
   RowBox[{"Mix", " ", "the", " ", "12", "  ", "spectra", " ", "into", " ", 
    RowBox[{"one", ":", "\[IndentingNewLine]", "ATTENTION", ":", " ", 
     RowBox[{"IN", " ", "NORMAL", " ", "ALTITUDE", " ", "ANGLES"}]}]}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"sphericaltoCartesian", "[", 
    RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "]"}], "=", 
   RowBox[{"CoordinateTransform", "[", 
    RowBox[{
     RowBox[{"\"\<Spherical\>\"", "\[Rule]", "\"\<Cartesian\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "\[Theta]", ",", "\[Phi]"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mathDodetoRealDodeAssoc", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"4", "\[Rule]", "\"\<A\>\""}], ",", 
     RowBox[{"2", "\[Rule]", "\"\<F\>\""}], ",", 
     RowBox[{"3", "\[Rule]", "\"\<B\>\""}], ",", 
     RowBox[{"11", "\[Rule]", "\"\<C\>\""}], ",", 
     RowBox[{"12", "->", "\"\<D\>\""}], ",", 
     RowBox[{"5", "\[Rule]", "\"\<E\>\""}], ",", 
     RowBox[{"9", "\[Rule]", "\"\<L\>\""}], ",", 
     RowBox[{"7", "\[Rule]", "\"\<K\>\""}], ",", 
     RowBox[{"10", "->", "\"\<J\>\""}], ",", 
     RowBox[{"1", "\[Rule]", "\"\<I\>\""}], ",", 
     RowBox[{"8", "\[Rule]", "\"\<H\>\""}], ",", 
     RowBox[{"6", "->", "\"\<G\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"polygonPoints", "[", "polygon_", "]"}], ":=", 
  RowBox[{"N", "[", 
   RowBox[{"polygon", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"normalVector", "[", "list_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p1", ",", "p2", ",", "p3"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p1", ",", "p2", ",", "p3"}], "}"}], "=", 
       RowBox[{"list", "[", 
        RowBox[{"[", 
         RowBox[{";;", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Cross", "[", 
       RowBox[{
        RowBox[{"p2", "-", "p1"}], ",", 
        RowBox[{"p3", "-", "p1"}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"polyhedronPolygonList", "=", 
   RowBox[{"PolyhedronData", "[", 
    RowBox[{"\"\<Dodecahedron\>\"", ",", "\"\<Polygons\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"normalArrow", "[", "polygon_", "]"}], ":=", 
   RowBox[{"Arrow", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RegionCentroid", "[", 
       RowBox[{"N", "@", "polygon"}], "]"}], ",", 
      RowBox[{
       RowBox[{"RegionCentroid", "[", 
        RowBox[{"N", "@", "polygon"}], "]"}], "+", 
       RowBox[{"normalVector", "[", 
        RowBox[{"polygonPoints", "[", "polygon", "]"}], "]"}]}]}], "}"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"degToRad", "[", "angle_", "]"}], " ", ":=", " ", 
  RowBox[{"angle", " ", 
   RowBox[{"\[Pi]", "/", "180."}]}]}], "\n", 
 RowBox[{
  RowBox[{"azimuthToPhi", "[", "azi_", "]"}], ":=", 
  RowBox[{"azi", "+", "90."}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"altitudeToTheta", "[", "alt_", "]"}], ":=", 
   RowBox[{"90.", "-", "alt"}]}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "see", " ", "additional", " ", "documentation", " ", "for", " ", "how", 
    " ", "anglular", " ", "dependence", " ", "from", " ", "the", " ", "LAD", 
    " ", "is", " ", "determined"}], " ", "*)"}], " "}], "\n", 
 RowBox[{
  RowBox[{"rotation", "=", 
   RowBox[{"Composition", "[", 
    RowBox[{
     RowBox[{"RotationTransform", "[", 
      RowBox[{
       RowBox[{"degToRad", "[", "30", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}], ",", 
     RowBox[{"RotationTransform", "[", 
      RowBox[{
       RowBox[{"degToRad", "[", 
        RowBox[{"-", "90"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"realNormalVectors", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"normalVector", "[", 
       RowBox[{"polygonPoints", "[", 
        RowBox[{"Normal", "[", 
         RowBox[{"GeometricTransformation", "[", 
          RowBox[{
           RowBox[{"polyhedronPolygonList", "[", 
            RowBox[{"[", "side", "]"}], "]"}], ",", "rotation"}], "]"}], 
         "]"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"side", ",", 
        RowBox[{"Range", "[", "12", "]"}]}], "}"}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"Keys", "[", 
      RowBox[{"Sort", "[", "mathDodetoRealDodeAssoc", "]"}], "]"}], "]"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"normDot", "[", 
   RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"a", ".", "b"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Norm", "[", "a", "]"}], 
     RowBox[{"Norm", "[", "b", "]"}]}], ")"}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"normDotSphericalOriented", "[", 
    RowBox[{"number_", ",", " ", "altitude_", 
     RowBox[{"(*", "*)"}], ",", " ", "azimuth_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", " ", "b"}], "}"}], ",", "\n", "  ", 
     RowBox[{
      RowBox[{"a", " ", "=", " ", 
       RowBox[{"realNormalVectors", "[", 
        RowBox[{"[", "number", "]"}], "]"}]}], ";", "\n", "  ", 
      RowBox[{"b", " ", "=", " ", 
       RowBox[{"sphericaltoCartesian", "[", 
        RowBox[{
         RowBox[{"degToRad", "[", 
          RowBox[{"altitudeToTheta", "[", "altitude", "]"}], "]"}], ",", 
         RowBox[{"degToRad", "[", 
          RowBox[{"azimuthToPhi", "[", "azimuth", "]"}], "]"}]}], "]"}]}], 
      ";", "\n", "  ", 
      RowBox[{"normDot", "[", 
       RowBox[{"a", ",", " ", "b"}], "]"}]}]}], "\n", "  ", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"polyWeights", "[", 
    RowBox[{"altitude_", ",", "azimuth_"}], "]"}], ":=", 
   RowBox[{"With", "[", "\n", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"list", "=", 
       RowBox[{"Clip", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"normDotSphericalOriented", "[", 
            RowBox[{"#", ",", "altitude", ",", "azimuth"}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", "12", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "10"}], "}"}]}], "]"}]}], "}"}], ",", "\n", 
     RowBox[{"list", "/", 
      RowBox[{"Total", "[", "list", "]"}]}]}], "\n", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"angleToRad", "[", "angle_", "]"}], ":=", 
  RowBox[{"angle", " ", 
   RowBox[{"\[Pi]", "/", "180"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fractionSolidAngle", "[", "x_", "]"}], "=", 
   RowBox[{
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "0", ",", 
        RowBox[{"angleToRad", "[", "x", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Phi]", ",", "0", ",", 
        RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{"4", "\[Pi]"}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"angleOpening", "=", 
    RowBox[{"x", "/.", 
     RowBox[{"Last", "@", 
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"10", "*", "20"}], "==", 
         RowBox[{
          RowBox[{"N", "@", "1"}], "/", 
          RowBox[{"fractionSolidAngle", "[", "x", "]"}]}]}], ",", "x"}], 
       "]"}]}]}]}], ";"}], "   ", "//", "Quiet"}], "\n", 
 RowBox[{
  RowBox[{"makeSpectra", "[", 
   RowBox[{"ladList_", ",", "time_", ",", "\[Theta]_", ",", "\[Phi]_"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"wavelengths", ",", 
     RowBox[{
      RowBox[{"1", "/", "1000"}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"/", "um"}], " ", 
        RowBox[{"to", " ", "/", "nm"}]}], "*)"}], " ", 
      RowBox[{"fractionSolidAngle", "[", "angleOpening", "]"}], "*", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"polyWeights", "[", 
         RowBox[{"\[Theta]", ",", "\[Phi]"}], "]"}], "*", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"trainedNet1", "[", 
           RowBox[{"listCalibrate", "[", 
            RowBox[{
             RowBox[{"ladList", "[", 
              RowBox[{"[", 
               RowBox[{"time", ",", "2", ",", "side"}], "]"}], "]"}], ",", 
             "side"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"side", ",", 
            RowBox[{"Range", "[", "12", "]"}]}], "}"}]}], "]"}]}], "]"}]}]}], 
    "}"}], "\[Transpose]"}]}]}], "Code",
 InitializationCell->False,
 CellChangeTimes->{{3.8190214120895853`*^9, 3.819021474123292*^9}, {
   3.826365224270172*^9, 3.8263653401554537`*^9}, {3.870591183877015*^9, 
   3.870591187941388*^9}, {3.870591389999117*^9, 3.8705913940307827`*^9}, {
   3.870591511913011*^9, 3.87059151995763*^9}, 3.870591656148329*^9, {
   3.870592476697068*^9, 3.870592489967723*^9}, 3.870592701205243*^9, 
   3.870614930616355*^9, {3.870874321562627*^9, 3.870874354072242*^9}, {
   3.870962197906674*^9, 3.870962198875606*^9}},
 CellLabel->
  "In[1418]:=",ExpressionUUID->"46b97799-db96-4493-99ff-5d1ca9974231"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"sphericaltoCartesianLSC", "[", 
     RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "]"}], "=", 
    RowBox[{"FromSphericalCoordinates", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{
        RowBox[{"\[Pi]", "/", "180."}], 
        RowBox[{"(", 
         RowBox[{"90.", "-", "\[Theta]"}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"-", "\[Pi]"}], "+", 
        RowBox[{"2", 
         RowBox[{"\[Pi]", " ", "/", "360."}], "\[Phi]"}]}]}], "}"}], "]"}]}], 
   ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"shifted", " ", "to", " ", "our", " ", "angle", " ", 
     RowBox[{"definition", ":", " ", 
      RowBox[{
      "normal", " ", "definition", " ", "is", " ", "theta", " ", "from", " ", 
       "0", " ", "to", " ", "pi"}]}]}], ",", " ", 
    RowBox[{
     RowBox[{"phi", " ", "from"}], " ", "-", 
     RowBox[{"pi", " ", "to", " ", "pi"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"normDot", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"a", ".", "b"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Norm", "[", "a", "]"}], 
       RowBox[{"Norm", "[", "b", "]"}]}], ")"}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "normed", " ", "dotproduct", " ", "to", " ", "calculate", " ", "the", " ", 
    "angle", " ", "between", " ", "sun", " ", "angle", " ", "and", " ", 
    "surface", " ", "normal"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"realAngleAtLSC", "[", " ", 
    RowBox[{"altitude_", ",", " ", "azimuth_"}], "]"}], " ", ":=", " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "effective", " ", "angle", " ", "between", " ", "lsc", " ", "and", " ", 
      "sun"}], ",", " ", 
     RowBox[{
     "we", " ", "can", " ", "do", " ", "this", " ", "since", " ", "the", " ", 
      "lsc", " ", "is", " ", "symmetric", " ", "in", " ", "the", " ", 
      "plane"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", " ", "b"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", " ", "=", " ", 
       RowBox[{"sphericaltoCartesian", "[", 
        RowBox[{
         RowBox[{"degToRad", "[", 
          RowBox[{"altitudeToTheta", "[", "lscAltitude", "]"}], "]"}], ",", 
         RowBox[{"degToRad", "[", 
          RowBox[{"azimuthToPhi", "[", "lscAzimuth", "]"}], "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"b", " ", "=", 
       RowBox[{"sphericaltoCartesian", "[", 
        RowBox[{
         RowBox[{"degToRad", "[", 
          RowBox[{"altitudeToTheta", "[", "altitude", "]"}], "]"}], ",", 
         RowBox[{"degToRad", "[", 
          RowBox[{"azimuthToPhi", "[", "azimuth", "]"}], "]"}]}], "]"}]}], 
      ";", 
      RowBox[{"(*", 
       RowBox[{
       "this", " ", "is", " ", "the", " ", "orientation", " ", "of", " ", 
        "the", " ", "surface", " ", "normal", " ", "of", " ", "the", " ", 
        "LSC"}], "*)"}], "\n", " ", 
      RowBox[{
       RowBox[{"ArcCos", "[", " ", 
        RowBox[{"normDot", "[", 
         RowBox[{"a", ",", " ", "b"}], "]"}], "]"}], 
       RowBox[{"180.", "/", 
        RowBox[{"(", "\[Pi]", ")"}]}]}]}]}], "\n", "  ", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"photonsNmMConversion", "[", "data_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "9"}], ")"}]}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"h", "*", "c"}], ")"}]}]}]}], "}"}], "&"}], "/@", 
    "data"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nmToeV", "[", "data_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"fac", "/", 
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"fac", 
         RowBox[{"(*", 
          RowBox[{
          "hc", " ", "in", " ", "units", " ", "of", " ", "eV", " ", "x", " ", 
           "nm"}], "*)"}], "/", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"fac", "/", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "^", 
          RowBox[{"(", "2", ")"}]}]}], 
        RowBox[{"(*", 
         RowBox[{"hc", "/", 
          RowBox[{"E", "^", "2"}]}], "*)"}], "*", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"W", "/", 
         RowBox[{"m", "^", "2"}]}], "/", "nm"}], "*)"}], "}"}], "&"}], "/@", 
    "data"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"photonsNmMConversion", "[", "data_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", 
            RowBox[{"10", "^", 
             RowBox[{"(", 
              RowBox[{"-", "9"}], ")"}]}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"h", "*", "c"}], ")"}]}]}]}], "}"}], "&"}], "/@", 
     "data"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"addFourLists", "[", 
    RowBox[{"{", 
     RowBox[{"list1_", ",", "list2_", ",", "list3_", ",", "list4_"}], "}"}], 
    "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"list1", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "\[Equal]", 
      RowBox[{"list2", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "==", 
      RowBox[{"list3", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "==", 
      RowBox[{"list4", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"list1", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"list1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "+", 
         RowBox[{"list2", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "+", 
         RowBox[{"list3", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "+", 
         RowBox[{"list4", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "}"}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[387]:=",ExpressionUUID->"5cc077cf-512d-4587-8847-b8fe589cbce3"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"(*", " ", "Constants", "  ", "*)"}], " "}], "Chapter"]], "Input",
 CellChangeTimes->{{3.805268608854138*^9, 3.8052686106660233`*^9}, {
  3.805268670496414*^9, 3.8052686765704536`*^9}, {3.805269004512122*^9, 
  3.8052690104407797`*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"ed1d4fa4-a95e-4ec4-b68e-882aaa37b43d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Constants", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"c", "=", "299792458."}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"units", ":", 
     RowBox[{"m", "/", "s"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"h", "=", 
     RowBox[{
      RowBox[{"6.6260695729", "*", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"-", "34"}], ")"}]}]}], "//", "N"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"units", ":", 
     RowBox[{
      RowBox[{"J", " ", "s"}], "-", 
      RowBox[{
       RowBox[{"Planck", "'"}], "s", " ", "Constant"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"h2", "=", 
     RowBox[{
      RowBox[{"4.136", "*", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"-", "15"}], ")"}]}]}], "//", "N"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"units", ":", 
     RowBox[{
      RowBox[{"eV", " ", "s"}], "-", 
      RowBox[{
       RowBox[{"Planck", "'"}], "s", " ", "Constant"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"q", "=", 
     RowBox[{
      RowBox[{"1.60217657", "*", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"-", "19"}], ")"}]}]}], "//", "N"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"units", ":", "Coulombs"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"k", "=", 
     RowBox[{
      RowBox[{"8.617", "*", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"\[Minus]", "5"}], ")"}]}]}], "//", "N"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"units", ":", 
     RowBox[{"eV", "/", "K"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"T", "=", 
     RowBox[{"298.15", "//", "N"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"units", ":", "K"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fac", "=", 
     RowBox[{
      RowBox[{"h", " ", "*", "c", " ", "*", 
       RowBox[{
        RowBox[{"10", "^", 
         RowBox[{"(", "9", ")"}]}], "/", "q"}]}], "//", "N"}]}], " ", ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"k2", "=", 
     RowBox[{
      RowBox[{"1.3807", "*", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"-", "23"}], ")"}]}]}], "//", "N"}]}], ";"}], "  ", 
   RowBox[{"(*", 
    RowBox[{"J", "/", "K"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearSystemCache", "[", "]"}], ";"}], "\n"}]}]], "Input",
 CellChangeTimes->{3.805347726041897*^9},
 CellLabel->
  "In[1443]:=",ExpressionUUID->"ad81bff5-1414-4400-b00c-49cc0a862850"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"(*", " ", 
    RowBox[{"Spectra", " ", "Conversion", " ", "Functions"}], "   ", "*)"}], 
   " "}], "Chapter"]], "Input",
 CellChangeTimes->{{3.805268608854138*^9, 3.8052686106660233`*^9}, {
  3.805268670496414*^9, 3.8052686765704536`*^9}, {3.805269004512122*^9, 
  3.8052690104407797`*^9}, {3.8052690409277143`*^9, 3.8052690446629057`*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"0a5ff604-4aa0-4258-bfb8-57c251bae1fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"spectra", " ", "conversion", " ", "functions"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Function", " ", "to", " ", "calculate", " ", "the", " ", "flux", " ", 
    "of", " ", "a", " ", "solar", " ", "spectrum"}], "*)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{"units", ":", 
    RowBox[{"A", "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"m", "^", "2"}], " ", "eV"}], ")"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"makeFlux", "[", "data_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"fac", "/", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"h", "*", "c"}], ")"}], "/", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"fac", "/", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "^", 
            RowBox[{"(", "2", ")"}]}]}], "*", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/", 
           RowBox[{"(", 
            RowBox[{"h", "*", "c"}], ")"}]}], "*", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"W", "/", 
           RowBox[{"m", "^", "2"}]}], "/", "nm"}], "*)"}], "}"}], "&"}], "/@",
       "data"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"makeFluxnm", "[", "data_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"q", "*", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"-", "9"}], ")"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"h", "*", "c"}], ")"}]}]}]}], "}"}], "&"}], "/@", 
      "data"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"unmakeFlux", "[", "data_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"fac", "/", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"h", "*", "c"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"fac", "/", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "*", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"fac", "/", 
              RowBox[{"(", 
               RowBox[{"fac", "/", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], ")"}], "^", 
            RowBox[{"(", "2", ")"}]}], "/", 
           RowBox[{"(", 
            RowBox[{"h", " ", "*", "c"}], ")"}]}]}]}], "}"}], "&"}], "/@", 
      "data"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"unmakeFluxnm", "[", "data_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/", "q"}], "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"h", "*", "c"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"-", "9"}], ")"}]}]}], ")"}]}]}]}], "}"}], "&"}], "/@",
       "data"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{3.8052690591222277`*^9, 3.822130916117034*^9},
 CellLabel->
  "In[1452]:=",ExpressionUUID->"f4c3fe4a-8d0f-4c15-8fa3-4ac4fae8ca64"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"(*", " ", 
    RowBox[{"Temperature", " ", "Dependencies"}], "   ", "*)"}], " "}], 
  "Chapter"]], "Input",
 CellChangeTimes->{{3.805268608854138*^9, 3.8052686106660233`*^9}, {
  3.805268670496414*^9, 3.8052686765704536`*^9}, {3.805269004512122*^9, 
  3.8052690104407797`*^9}, {3.8052690409277143`*^9, 3.8052690446629057`*^9}, {
  3.8052690849163923`*^9, 3.805269089437516*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"0ca3ad0f-daa5-413d-abe5-fb17d965280a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Temperature", " ", "dependencies"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Temperature", " ", "dependent", " ", "intrinsic", " ", "charge", " ", 
     "carrier", " ", "concentration", " ", "from", " ", 
     RowBox[{"K", ".", "Misiakos"}]}], ",", 
    RowBox[{"et", " ", 
     RowBox[{"al", ".", "Accurate"}], " ", "Measurements", " ", "of", " ", 
     "the", " ", "Silicon", " ", "Intrinsic", " ", "Carrier", " ", "Density", 
     " ", "from", " ", "78", " ", "to", " ", "340", " ", 
     RowBox[{"K", ".", "J", ".", "Appl", ".", "Phys"}], ".1993"}], ",", "74", 
    ",", "3293", "\[Dash]", 
    RowBox[{"3297", " ", 
     RowBox[{"DOI", ":", 
      RowBox[{"10.1063", "/", "1.354551"}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"units", ":", 
    RowBox[{"m", "^", 
     RowBox[{"-", "3"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Sini", "[", "T_Real", "]"}], ":=", 
     RowBox[{"5.29", "*", 
      RowBox[{"10", "^", 
       RowBox[{"(", "19", ")"}]}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"T", "/", "300."}], ")"}], "^", 
       RowBox[{"(", "2.54", ")"}]}], "*", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "6726."}], "/", "T"}], "]"}], "*", 
      RowBox[{"10", "^", 
       RowBox[{"(", "6", ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
       "Temperature", " ", "dependent", " ", "bandgap", " ", "is", " ", 
        "calculated", " ", "using", " ", "Varshni"}], "\[CloseCurlyQuote]"}], 
      "s", " ", "empirical", " ", "equation", " ", "with", " ", "values", " ",
       "from", " ", "the", " ", "book", " ", "Physics", " ", "of", " ", 
      "Semiconductor", " ", "Devices", " ", "Physics", " ", "of", " ", 
      "Semiconductor", " ", "Devices"}], ",", 
     RowBox[{"Wiley", "-", "Interscience"}], ",", 
     RowBox[{"1995", " ", "from", " ", "Sze"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"units", ":", "eV"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"ClearAll", "[", "SiBandgap", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SiBandgap", "[", "Temp_Real", "]"}], ":=", 
     RowBox[{"1.17", "-", 
      RowBox[{"4.73", "*", 
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"-", "4"}], ")"}]}], "*", " ", 
       RowBox[{
        RowBox[{"Temp", "^", 
         RowBox[{"(", "2", ")"}]}], "/", 
        RowBox[{"(", 
         RowBox[{"Temp", "+", "636."}], ")"}]}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Temperature", " ", "dependent", " ", "Auger", " ", "coefficient", " ", 
      "from", " ", 
      RowBox[{"J", ".", "Dziewior"}], " ", "et", " ", 
      RowBox[{"al", ".", "Auger"}], " ", "Coefficients", " ", "for", " ", 
      "Highly", " ", "Doped", " ", "and", " ", "Highly", " ", "Excited", " ", 
      RowBox[{"Silicon", ".", "Appl", ".", "Phys", ".", "Lett"}], ".1977"}], 
     ",", "346", ",", "11", "\[Dash]", 
     RowBox[{"14", " ", 
      RowBox[{"DOI", ":", 
       RowBox[{"10.1063", "/", "1.89694"}]}]}]}], "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"Cn", "=", 
     RowBox[{
      RowBox[{"2.8", " ", "x", " ", 
       RowBox[{"10", "^", 
        RowBox[{"-", "31"}]}], " ", 
       RowBox[{
        RowBox[{"cm", "^", "6"}], "/", "s"}], " ", "Cp"}], "=", 
      RowBox[{"0.99", " ", "x", " ", 
       RowBox[{"10", "^", 
        RowBox[{"-", "31"}]}], 
       RowBox[{
        RowBox[{"cm", "^", "6"}], "/", "s"}], " ", 
       RowBox[{"units", ":", 
        RowBox[{
         RowBox[{"m", "^", "6"}], "/", "s"}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SiC", "[", "T_Real", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2.8", " ", "+", " ", "0.99"}], ")"}], "*", 
      RowBox[{"10", "^", 
       RowBox[{"(", 
        RowBox[{"-", "43"}], ")"}]}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"T", "/", "300."}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"1.", "/", "2."}], ")"}]}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8218652861935596`*^9, 3.8218652919680347`*^9}, {
  3.82213190708392*^9, 3.8221319155906687`*^9}},
 CellLabel->
  "In[1456]:=",ExpressionUUID->"42558fd6-369f-4530-af85-719e3dc10f1f"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"(*", " ", 
    RowBox[{"Current", "  ", "Densities"}], "   ", "*)"}], " "}], 
  "Chapter"]], "Input",
 CellChangeTimes->{{3.805268608854138*^9, 3.8052686106660233`*^9}, {
  3.805268670496414*^9, 3.8052686765704536`*^9}, {3.805269004512122*^9, 
  3.8052690104407797`*^9}, {3.8052690409277143`*^9, 3.8052690446629057`*^9}, {
  3.8052690849163923`*^9, 3.805269108618724*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"45b4b28a-9fdd-471b-8345-a30d72ced460"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Current", " ", "densities"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Radiative", " ", "recombination", " ", "current", " ", "density"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"JRad0Si", "=", 
     RowBox[{"q", "*", "2", "*", 
      RowBox[{"Pi", "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", "^", 
          RowBox[{"(", "2", ")"}]}], "*", 
         RowBox[{"h2", "^", 
          RowBox[{"(", "3", ")"}]}]}], ")"}]}], "*", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"En", "^", 
          RowBox[{"(", "2", ")"}]}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{"En", "/", 
             RowBox[{"(", 
              RowBox[{"k", "*", "T"}], ")"}]}], "]"}], "-", "1"}], ")"}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"En", ",", 
          RowBox[{"SiBandgap", "[", "T", "]"}], ",", "4.4"}], "}"}]}], 
       "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"JRSi", "[", 
      RowBox[{"V_Real", ",", "Il_Real", ",", "Rs_Real"}], "]"}], ":=", 
     RowBox[{"JRad0Si", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"V", "+", 
            RowBox[{"Il", "*", "Rs", "*", "0.0001"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"k", " ", "T"}], ")"}]}], "]"}], "-", "1"}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Auger", " ", "recombination", " ", "current", " ", "density"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"JRAuger", "[", 
      RowBox[{"V_Real", ",", "Il_Real", ",", "Rs_Real", ",", "L_Real"}], 
      "]"}], ":=", 
     RowBox[{"q", "*", "L", "*", 
      RowBox[{"SiC", "[", "T", "]"}], "*", 
      RowBox[{
       RowBox[{"Sini", "[", "T", "]"}], "^", "3"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"3", " ", 
            RowBox[{"(", 
             RowBox[{"V", "+", 
              RowBox[{"Il", "*", "Rs", "*", "0.0001"}]}], ")"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"2", "*", "k", "*", "T"}], ")"}]}], "]"}], "-", "1"}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Non", "-", 
     RowBox[{
     "radiative", " ", "recombination", " ", "current", " ", "density"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"JRnon", "[", 
      RowBox[{"V_Real", ",", "Il_Real", ",", "Rs_Real", ",", "INR_Real"}], 
      "]"}], ":=", 
     RowBox[{"INR", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "42"}]}], " ", 
      RowBox[{
       RowBox[{"Sini", "[", "T", "]"}], "^", "2"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"V", "+", 
            RowBox[{"Il", "*", "Rs", "*", "0.0001"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"k", " ", "T"}], ")"}]}], "]"}], "-", "1"}], ")"}]}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "Resistance", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Resistance", "[", 
      RowBox[{"V_Real", ",", "Il_Real", ",", "Rs_Real", ",", "Rsh_Real"}], 
      "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"V", "+", 
        RowBox[{"Il", "*", "Rs", "*", "0.0001"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"Rsh", "*", "0.0001"}], ")"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.805269135247993*^9, 3.8052691447098227`*^9}, {
  3.82213191717039*^9, 3.822131918312717*^9}},
 CellLabel->
  "In[1460]:=",ExpressionUUID->"91cfc03c-e6a4-435f-a752-3465ea327270"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"(*", " ", 
    RowBox[{"More", " ", "Constants"}], "   ", "*)"}], " "}], 
  "Chapter"]], "Input",
 CellChangeTimes->{{3.805268608854138*^9, 3.8052686106660233`*^9}, {
  3.805268670496414*^9, 3.8052686765704536`*^9}, {3.805269004512122*^9, 
  3.8052690104407797`*^9}, {3.8052690409277143`*^9, 3.8052690446629057`*^9}, {
  3.8052690849163923`*^9, 3.805269108618724*^9}, {3.805269164071608*^9, 
  3.805269173915454*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"869e268f-131e-4248-b324-24e0979d96e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Fitting", " ", "values"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Thickness", " ", "of", " ", "silicon", " ", "for", " ", "Auger", " ", 
    "recombination", " ", "in", " ", "m"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"thicknesses", "=", 
     RowBox[{"{", 
      RowBox[{"(*", "1", "*)"}], 
      RowBox[{
       RowBox[{"1.7", "*", 
        RowBox[{"10", "^", 
         RowBox[{"-", "4"}]}]}], ",", 
       RowBox[{"(*", "2", "*)"}], 
       RowBox[{"1.8", "*", 
        RowBox[{"10", "^", 
         RowBox[{"-", "4"}]}]}], ",", 
       RowBox[{"(*", "assumption", "*)"}], 
       RowBox[{"(*", "3", "*)"}], 
       RowBox[{"1.8", "*", 
        RowBox[{"10", "^", 
         RowBox[{"-", "4"}]}]}], ",", 
       RowBox[{"(*", "4", "*)"}], 
       RowBox[{"1.9", "*", 
        RowBox[{"10", "^", 
         RowBox[{"-", "4"}]}]}], ",", 
       RowBox[{"(*", "5", "*)"}], 
       RowBox[{"1.8", "*", 
        RowBox[{"10", "^", 
         RowBox[{"-", "4"}]}]}], ",", 
       RowBox[{"(*", "assumption", "*)"}], 
       RowBox[{"(*", "6", "*)"}], 
       RowBox[{"1.8", "*", 
        RowBox[{"10", "^", 
         RowBox[{"-", "4"}]}]}], ",", 
       RowBox[{"(*", "assumption", "*)"}], 
       RowBox[{"(*", "7", "*)"}], 
       RowBox[{"1.9", "*", 
        RowBox[{"10", "^", 
         RowBox[{"-", "4"}]}]}], ",", 
       RowBox[{"(*", "8", "*)"}], 
       RowBox[{"1.95", "*", 
        RowBox[{"10", "^", 
         RowBox[{"-", "4"}]}]}], ",", 
       RowBox[{"(*", "9", "*)"}], 
       RowBox[{"1.5", "*", 
        RowBox[{"10", "^", 
         RowBox[{"-", "4"}]}]}], ",", 
       RowBox[{"(*", "10", "*)"}], 
       RowBox[{"2", "*", 
        RowBox[{"10", "^", 
         RowBox[{"-", "4"}]}]}], ",", 
       RowBox[{"(*", "11", "*)"}], 
       RowBox[{"1.5", "*", 
        RowBox[{"10", "^", 
         RowBox[{"-", "4"}]}]}], ",", 
       RowBox[{"(*", "12", "*)"}], 
       RowBox[{"2", "*", 
        RowBox[{"10", "^", 
         RowBox[{"-", "4"}]}]}], ",", 
       RowBox[{"(*", "13", "*)"}], 
       RowBox[{"2", "*", 
        RowBox[{"10", "^", 
         RowBox[{"-", "4"}]}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\n", 
   RowBox[{"(*", 
    RowBox[{"Parasitic", " ", "resistances", " ", "in", " ", "ohm", " ", 
     RowBox[{"cm", "^", "2"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Rs", "=", 
     RowBox[{"{", 
      RowBox[{"(*", "1", "*)"}], 
      RowBox[{"1.48", ",", 
       RowBox[{"(*", "2", "*)"}], "1.15", ",", 
       RowBox[{"(*", "3", "*)"}], "1.35", ",", 
       RowBox[{"(*", "4", "*)"}], "0.82", ",", 
       RowBox[{"(*", "5", "*)"}], "1.28", ",", 
       RowBox[{"(*", "6", "*)"}], "0.73", ",", 
       RowBox[{"(*", "7", "*)"}], "0.59", ",", 
       RowBox[{"(*", "8", "*)"}], "0.6", ",", 
       RowBox[{"(*", "9", "*)"}], "0.67", ",", 
       RowBox[{"(*", "10", "*)"}], "0.75", ",", 
       RowBox[{"(*", "11", "*)"}], "0.47", ",", 
       RowBox[{"(*", "12", "*)"}], "0.31", ",", 
       RowBox[{"(*", "13", "*)"}], "0.08"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Rsh", "=", 
     RowBox[{"{", 
      RowBox[{"(*", "1", "*)"}], 
      RowBox[{"1800", ",", 
       RowBox[{"(*", "2", "*)"}], "1300", ",", 
       RowBox[{"(*", "3", "*)"}], "1800", ",", 
       RowBox[{"(*", "4", "*)"}], "1800", ",", 
       RowBox[{"(*", "5", "*)"}], "1200", ",", 
       RowBox[{"(*", "6", "*)"}], "2000", ",", 
       RowBox[{"(*", "7", "*)"}], "2000", ",", 
       RowBox[{"(*", "8", "*)"}], "3000", ",", 
       RowBox[{"(*", "9", "*)"}], "2000", ",", 
       RowBox[{"(*", "10", "*)"}], "800", ",", 
       RowBox[{"(*", "11", "*)"}], "4000", ",", 
       RowBox[{"(*", "12", "*)"}], "6000", ",", 
       RowBox[{"(*", "13", "*)"}], "10000"}], "}"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Non", "-", 
     RowBox[{"radiative", " ", "recombination"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"INR", "=", 
     RowBox[{"{", 
      RowBox[{"(*", "1", "*)"}], 
      RowBox[{"58", ",", 
       RowBox[{"(*", "2", "*)"}], "85.7", ",", 
       RowBox[{"(*", "3", "*)"}], "56", ",", 
       RowBox[{"(*", "4", "*)"}], "58", ",", 
       RowBox[{"(*", "5", "*)"}], "10.5", ",", 
       RowBox[{"(*", "6", "*)"}], "43", ",", 
       RowBox[{"(*", "7", "*)"}], "35", ",", 
       RowBox[{"(*", "8", "*)"}], "24.1", ",", 
       RowBox[{"(*", "9", "*)"}], "1.5", ",", 
       RowBox[{"(*", "10", "*)"}], "1.95", ",", 
       RowBox[{"(*", "11", "*)"}], "1.7", ",", 
       RowBox[{"(*", "12", "*)"}], "1.41", ",", 
       RowBox[{"(*", "13", "*)"}], "1.88485"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{3.82213192579708*^9},
 CellLabel->
  "In[1465]:=",ExpressionUUID->"839ad805-4b69-4644-a34f-ec00791d8948"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"(*", " ", 
    RowBox[{"IV", " ", "Characteristics"}], "   ", "*)"}], " "}], 
  "Chapter"]], "Input",
 CellChangeTimes->{{3.805268608854138*^9, 3.8052686106660233`*^9}, {
  3.805268670496414*^9, 3.8052686765704536`*^9}, {3.805269004512122*^9, 
  3.8052690104407797`*^9}, {3.8052690409277143`*^9, 3.8052690446629057`*^9}, {
  3.8052690849163923`*^9, 3.805269108618724*^9}, {3.805269164071608*^9, 
  3.805269173915454*^9}, {3.8052692072734547`*^9, 3.805269211053802*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"03e6511b-1e3e-4cab-9917-a8cb0fbbbe20"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Import", " ", "JV", " ", "characteristic"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"IV13", "=", 
     RowBox[{"Import", "[", "\"\<./Record_Si_cell/13_IV.csv\>\"", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Import", " ", "EQE"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EQE13", "=", 
     RowBox[{"Import", "[", "\"\<./Record_Si_cell/13_EQE.csv\>\"", "]"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"intEQE13", "=", 
     RowBox[{"Interpolation", "[", 
      RowBox[{"EQE13", ",", 
       RowBox[{"InterpolationOrder", "\[Rule]", "0"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.805269237918982*^9, {3.805269272897306*^9, 3.805269275604493*^9}, 
   3.870603113324345*^9, 3.870866812869629*^9},
 CellLabel->
  "In[1469]:=",ExpressionUUID->"2d4afeb1-d748-47b3-8630-54199d87069a"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"(*", " ", 
    RowBox[{"Si", " ", "Effects"}], "  ", "*)"}], " "}], "Chapter"]], "Input",
 CellChangeTimes->{{3.808549583137394*^9, 3.808549593135664*^9}, {
  3.870614983450902*^9, 
  3.870614986570486*^9}},ExpressionUUID->"ec7016f8-ec00-4c4f-b230-\
ecfbc807ede5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"spectraAtSolarCell", "[", 
    RowBox[{
    "monthdata_", ",", "timestamp_", ",", "altitudePhoton_", ",", 
     "azimuthPhoton_", ",", "rayTracingPhotons_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "absAngle", ",", "interpolationW", ",", "interpolationPhoton", ",", 
       "scaledCurrent", ",", "spectrum", ",", "totalspectrumW", ",", 
       "photonsPermNm", ",", "totalPhoton", ",", "outputInterpolCurrenteV", 
       ",", "jG", ",", "outputCurrent", ",", "outputCurrentInterpol", ",", 
       "totalOutputCurrent", ",", "opticalEfficiency"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "if", " ", "emission", " ", "max", " ", "happens", " ", "to", " ", 
        "be", " ", "the", " ", "same", " ", "as", " ", "one", " ", "of", " ", 
        "the", " ", "points", " ", "in", " ", "spectrum"}], ",", " ", 
       RowBox[{
       "there", " ", "will", " ", "be", " ", "problem", " ", "in", " ", 
        "interpolation"}], ",", " ", 
       RowBox[{
       "just", " ", "make", " ", "sure", " ", "emission", " ", "max", " ", 
        "is", " ", "an", " ", "integer"}]}], " ", "*)"}], " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"spectrum", "=", 
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"makeSpectra", "[", 
          RowBox[{
          "monthdata", ",", "timestamp", ",", "altitudePhoton", ",", 
           "azimuthPhoton"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"emissionmax", ",", "0"}], "}"}]}], "]"}]}], 
      RowBox[{"(*", 
       RowBox[{"in", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"W", "/", 
           RowBox[{"m", "^", "2"}]}], "/", "nm"}], "/", "Xsr"}]}], "*)"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"interpolationW", "=", 
       RowBox[{"Interpolation", "[", 
        RowBox[{"spectrum", ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "0"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"totalspectrumW", "=", 
       RowBox[{"Integrate", "[", 
        RowBox[{
         RowBox[{"interpolationW", "[", "\[Lambda]", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Lambda]", ",", 
           RowBox[{"spectrum", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"spectrum", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"photonsPermNm", "=", 
       RowBox[{"photonsNmMConversion", "[", "spectrum", "]"}]}], 
      RowBox[{"(*", 
       RowBox[{"in", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"photons", "/", 
           RowBox[{"m", "^", "2"}]}], "/", "nm"}], "/", "Xsr"}]}], "*)"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"interpolationPhoton", "=", 
       RowBox[{"Interpolation", "[", 
        RowBox[{"photonsPermNm", ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "0"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"totalPhoton", "=", 
       RowBox[{"Integrate", "[", 
        RowBox[{
         RowBox[{"interpolationPhoton", "[", "x", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "288", ",", "emissionmax"}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"absAngle", " ", "=", 
       RowBox[{"Round", "[", 
        RowBox[{"90", "-", 
         RowBox[{"Abs", "[", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"realAngleAtLSC", "[", 
             RowBox[{"altitudePhoton", ",", "azimuthPhoton"}], "]"}], "-", 
            "90"}], ")"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Make", " ", "output", " ", "current", " ", "for", " ", "all", " ", 
        "four", " ", "sides", " ", "PER", " ", "ANGLE"}], "  ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "this", " ", "is", " ", "a", " ", "current", " ", "flux", " ", "in"}], 
       " ", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "/", 
           RowBox[{"m", "^", "2"}]}], "/", "nm"}], "/", "Xsr"}], "*)"}], " ", 
       "*)"}], " ", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "total", " ", "photons", " ", "in", " ", "is", " ", "actually", " ", 
         "divided", " ", "by", " ", "4"}], ",", " ", 
        RowBox[{"because", " ", "if", " ", "it", " ", "was", " ", "10000"}], 
        ",", " ", 
        RowBox[{
         RowBox[{"you", "'"}], "d", " ", "be", " ", "dividing", " ", "by", 
         " ", "10000"}]}], " ", "*)"}], " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"scaledCurrentF", "[", "side_", "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"output", ",", "result"}], "}"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"WithCleanup", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"SetSystemOptions", "[", 
             RowBox[{"\"\<CompileOptions\>\"", "->", 
              RowBox[{"\"\<TableCompileLength\>\"", "->", "Infinity"}]}], 
             "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"output", " ", "=", " ", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"wlength", ",", 
                  RowBox[{"q", "*", " ", 
                   RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{"interpolationPhoton", "[", "wlength", "]"}], 
                    "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"N", "[", "totalphotonsin", "]"}], "/", "4"}], 
                    ")"}]}], " ", "*", 
                   RowBox[{"Normal", "[", 
                    RowBox[{"raytracingdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"side", ",", "absAngle", ",", 
                    RowBox[{"wlength", "-", "emissionmin", "+", "1"}]}], 
                    "]"}], "]"}], "]"}]}]}], "}"}], " ", ",", " ", 
                RowBox[{"{", 
                 RowBox[{
                 "wlength", ",", " ", "emissionmin", ",", " ", "emissionmax", 
                  ",", "1"}], "}"}]}], "]"}]}], ";"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"SetSystemOptions", "[", 
             RowBox[{"\"\<CompileOptions\>\"", "->", 
              RowBox[{"\"\<TableCompileLength\>\"", "->", "250"}]}], "]"}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "this", " ", "is", " ", "just", " ", "the", " ", "output", " ", 
            "spectra"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
          RowBox[{"output", " ", "=", 
           RowBox[{"output", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", "2"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"result", " ", "is", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"nm", " ", "out"}], ",", " ", "total"}], "}"}]}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"result", " ", "=", " ", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Lambda]", ",", 
               RowBox[{"Total", "[", 
                RowBox[{"output", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", ",", 
                   RowBox[{"\[Lambda]", "-", "emissionmin", "+", "1"}]}], 
                  "]"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Lambda]", ",", 
               RowBox[{"wavelengthtable", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "result", "]"}]}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"add", " ", "each", " ", "side"}], " ", "*)"}], " ", 
      "\[IndentingNewLine]", 
      RowBox[{"outputCurrent", "=", 
       RowBox[{"addFourLists", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"scaledCurrentF", "[", "1", "]"}], ",", 
          RowBox[{"scaledCurrentF", "[", "2", "]"}], ",", 
          RowBox[{"scaledCurrentF", "[", "3", "]"}], ",", 
          RowBox[{"scaledCurrentF", "[", "4", "]"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"interpolate", " ", "the", " ", "current"}], ",", " ", 
        RowBox[{"for", " ", "all", " ", "4", " ", "sides"}], ",", " ", 
        RowBox[{"convert", " ", "to", " ", 
         RowBox[{
          RowBox[{"W", "/", 
           RowBox[{"m", "^", "2"}]}], "/", "sr"}]}]}], "*)"}], " ", 
      "\[IndentingNewLine]", 
      RowBox[{"outputCurrentInterpol", "=", 
       RowBox[{"Interpolation", "[", 
        RowBox[{"outputCurrent", ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "0"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"totalOutputpower", "=", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"N", "[", 
            RowBox[{"1240", "/", "x"}], "]"}], ")"}], "*", 
          RowBox[{"outputCurrentInterpol", "[", "x", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{"outputCurrent", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "emissionmax"}], 
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"convert", " ", "to", " ", "eV"}], " ", "-"}], 
       RowBox[{"(*", 
        RowBox[{"in", " ", 
         RowBox[{
          RowBox[{"A", "/", 
           RowBox[{"m", "^", "2"}]}], "/", "sr"}]}], "*)"}], " ", "*)"}], " ",
       "\[IndentingNewLine]", 
      RowBox[{"outputInterpolCurrenteV", "=", 
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{"nmToeV", "[", "outputCurrent", "]"}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "0"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"jG", "=", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"intEQE13", "[", "En", "]"}], "*", 
          RowBox[{"outputInterpolCurrenteV", "[", "En", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"En", ",", 
           RowBox[{"fac", "/", 
            RowBox[{"outputCurrent", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], ",", 
           RowBox[{"fac", "/", 
            RowBox[{"outputCurrent", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"MaxRecursion", "\[Rule]", "10000"}], ",", 
         RowBox[{"WorkingPrecision", "\[Rule]", "4"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "totalspectrumW", ",", "totalPhoton", ",", "totalOutputpower", ",", 
        "jG"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.823348567559738*^9, 3.8233485699468393`*^9}, 
   3.8233486081038647`*^9, {3.8233492966415253`*^9, 3.82334929951202*^9}, {
   3.823349683653576*^9, 3.8233497611959457`*^9}, {3.823349837650498*^9, 
   3.823349902235362*^9}, {3.823944544962017*^9, 3.82394463491166*^9}, {
   3.870593144752537*^9, 3.8705932306631804`*^9}, {3.870593281121747*^9, 
   3.870593288586858*^9}, {3.870593319522194*^9, 3.870593353411354*^9}, {
   3.870593387541947*^9, 3.8705935302851067`*^9}, {3.870593567311352*^9, 
   3.870593572854435*^9}, {3.8705951777146273`*^9, 3.870595187670649*^9}, {
   3.87059555474479*^9, 3.87059566385608*^9}, {3.870595699916917*^9, 
   3.870595767397184*^9}, {3.870596244771751*^9, 3.870596261828701*^9}, {
   3.8706041687843943`*^9, 3.870604220804031*^9}, {3.870614996716895*^9, 
   3.870615008772737*^9}, {3.8706152948372517`*^9, 3.870615303089794*^9}, {
   3.870617597602158*^9, 3.8706176103991423`*^9}, {3.8706177066184263`*^9, 
   3.8706177191921663`*^9}, {3.870617901857374*^9, 3.87061790536058*^9}, 
   3.8706182191623993`*^9, {3.870618287043797*^9, 3.870618355800191*^9}, {
   3.870618406022057*^9, 3.870618407304237*^9}, {3.8706194683479853`*^9, 
   3.8706194727802753`*^9}, {3.87061950350749*^9, 3.870619508097207*^9}, {
   3.870619546789713*^9, 3.870619551298595*^9}, 3.870676261997624*^9, {
   3.870676386494032*^9, 3.870676415434663*^9}, {3.870676448779786*^9, 
   3.870676470954199*^9}, {3.870676852246014*^9, 3.870676854077694*^9}, {
   3.870677474954873*^9, 3.870677544866447*^9}, {3.870677589795302*^9, 
   3.870677597430665*^9}, 3.870703673613803*^9, {3.870863609613762*^9, 
   3.870863630305913*^9}, {3.870864055133946*^9, 3.870864056212075*^9}, {
   3.870864138093939*^9, 3.870864169985347*^9}, {3.870864295526103*^9, 
   3.870864313814643*^9}, {3.8708664953690557`*^9, 3.87086649554503*^9}, {
   3.870866719003828*^9, 3.870866744990128*^9}, 3.8708676616745853`*^9, {
   3.873225272979545*^9, 
   3.873225300451689*^9}},ExpressionUUID->"af865f47-6fe3-4ae6-b670-\
4dd7f2a2974e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"sicell", "[", 
    RowBox[{
    "areasurface_", ",", "areaside_", ",", "side_Integer", ",", "monthvalue_",
      ",", "pointinmonth_Integer"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "time", ",", "incidentangle", ",", "spectradirect", ",", 
       "spectradiffuse", ",", "intspectradirect", ",", "intspectradiffuse", 
       ",", "intfluxnmdirect", ",", "intfluxnmdiffuse", ",", "concentration", 
       ",", "totalincidentpowerdiffuse", ",", 
       "totalconcentratedincidentpowerdiffuse", ",", 
       "totalincidentpowerdirect", ",", 
       "totalconcentratedincidentpowerdirect", ",", "totalfluxdiffuse", ",", 
       "totalfluxdirect", ",", "LSCoutputlistdirect", ",", 
       "sidespectrafluxdirect", ",", "LSCoutputlistdiffuse", ",", 
       "sidespectrafluxdiffuse", ",", "sidespectradirect", ",", 
       "sidespectradiffuse", ",", "outputpowerLSCdiffuse", ",", 
       "outputpowerLSCdirect", ",", "JG", ",", "jg", ",", "dSi", ",", 
       "totalefficiency", ",", "outputpowerLSC", ",", "LSCefficiency", ",", 
       "efficiency", ",", "JGdirect", ",", "LSCfluxefficiencydirect", ",", 
       "LSCfluxefficiencydiffuse", ",", "kwhSi", ",", "kwhLSCdirect", ",", 
       "kwhLSCdiffuse", ",", "monthdata"}], "}"}], ",", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "select", " ", "the", " ", "data", " ", "you", " ", "want", " ", "from",
        " ", "the", " ", "LAD"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"monthdata", " ", "=", "monthdatalad"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"date", "=", 
       RowBox[{"DateString", "[", 
        RowBox[{"DateObject", "[", 
         RowBox[{"monthdata", "[", 
          RowBox[{"[", 
           RowBox[{"pointinmonth", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "date", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ClearSystemCache", "[", "]"}], ";", "\n", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"geometric", " ", "concentration"}], " ", "*)"}], " ", 
      "\[IndentingNewLine]", 
      RowBox[{"concentration", "=", 
       RowBox[{"N", "[", 
        RowBox[{"areasurface", "/", 
         RowBox[{"(", 
          RowBox[{"4", "*", "areaside"}], ")"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "this", " ", "calculates", " ", "the", " ", "spectra", " ", "at", " ",
          "every", " ", "angle", " ", "in", " ", "altitude", " ", "and", " ", 
         "azimuth", " ", "at", " ", "up", " ", "to", " ", "every", " ", "10", 
         "s", " ", "interval", " ", "throughout", " ", "the", " ", "year", 
         " ", "if", " ", "this", " ", "number", " ", "of", " ", "steps", " ", 
         "are", " ", "changed", " ", 
         RowBox[{"(", 
          RowBox[{"10", " ", "and", " ", "20"}], ")"}], " ", "you", " ", 
         "must", " ", "also", " ", "change", " ", "the", " ", "solid", " ", 
         "angle"}], " ", "-", " ", 
        RowBox[{
        "in", " ", "the", " ", "function", " ", "angleopening", " ", 
         "function"}]}], "*)"}], " ", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"spectra", " ", "at", " ", "solarcell", " ", "outputs", " ", 
        RowBox[{"{", 
         RowBox[{
         "totalspectrumW", ",", "totalPhoton", ",", "totalOutputCurrent", ",",
           "jG"}], "}"}]}], " ", "*)"}], " ", "\[IndentingNewLine]", 
      RowBox[{"spectraAtSolarCelltemp", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"spectraAtSolarCell", "[", 
            RowBox[{"monthdata", ",", "pointinmonth", ",", 
             RowBox[{"(*", 
              RowBox[{"angle", " ", "alt"}], "*)"}], "alt", ",", 
             RowBox[{"(*", 
              RowBox[{"angle", " ", "azi"}], "*)"}], "azi", ",", 
             "totalphotonsin"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"alt", ",", "1", ",", "179", ",", 
             RowBox[{"180", "/", "10"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"azi", ",", "1", ",", "359", ",", 
             RowBox[{"360", "/", "20"}]}], "}"}]}], "]"}], ",", "1"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"total", " ", "current", " ", "density", " ", 
         RowBox[{"A", "/", 
          RowBox[{"m", "^", "2"}]}]}], " ", ",", " ", 
        RowBox[{"from", " ", "each", " ", "angle"}]}], " ", "*)"}], " ", 
      "\[IndentingNewLine]", 
      RowBox[{"jg", "=", 
       RowBox[{"concentration", " ", "*", 
        RowBox[{"Total", "[", 
         RowBox[{"spectraAtSolarCelltemp", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<jg:  \>\"", "<>", 
        RowBox[{"ToString", "[", "jg", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "total", " ", "incoming", " ", "power", " ", "density", " ", "onto", 
        " ", "the", " ", "LSC"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"remembver", ",", " ", 
        RowBox[{
        "if", " ", "you", " ", "change", " ", "the", " ", "step", " ", "size",
          " ", "in", " ", "alt", " ", "or", " ", "azi"}], ",", " ", 
        RowBox[{
        "you", " ", "need", " ", "to", " ", "make", " ", "sure", " ", "that", 
         " ", "you", " ", "are", " ", "dealing", " ", "with", " ", "the", " ",
          "solid", " ", "angle", " ", "incomign", " ", "correctly"}]}], " ", 
       "*)"}], " ", "\[IndentingNewLine]", 
      RowBox[{"totalIncomingPower", "=", 
       RowBox[{"Total", "[", 
        RowBox[{"spectraAtSolarCelltemp", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<incoming Power:  \>\"", "<>", 
        RowBox[{"ToString", "[", "totalIncomingPower", "]"}], "<>", 
        "\"\<in W/m^2\>\""}], "]"}], ";", "\n", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"calculate", " ", "total", " ", "power"}], ",", " ", 
        RowBox[{"which", " ", "in", " ", 
         RowBox[{"W", "/", 
          RowBox[{"m", "^", "2"}]}]}]}], " ", "*)"}], " ", 
      "\[IndentingNewLine]", 
      RowBox[{"totaloutputLSCpower", "=", 
       RowBox[{"Total", "[", 
        RowBox[{"spectraAtSolarCelltemp", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<totaloutputLSCpower:  \>\"", "<>", 
        RowBox[{"ToString", "[", "totaloutputLSCpower", "]"}], "<>", 
        "\"\<in W/m^2\>\""}], "]"}], ";", "\n", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Make", " ", "JV", " ", "characteristic", " ", "in", " ", 
        RowBox[{"A", "/", 
         RowBox[{"m", "^", "2"}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"dSi", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"v1", ",", 
           RowBox[{
            RowBox[{"FindRoot", "[", 
             RowBox[{
              RowBox[{"Il", "\[Equal]", 
               RowBox[{"jg", "-", 
                RowBox[{"JRSi", "[", 
                 RowBox[{"v1", ",", "Il", ",", 
                  RowBox[{"Rs", "[", 
                   RowBox[{"[", "cell", "]"}], "]"}]}], "]"}], "-", 
                RowBox[{"JRAuger", "[", 
                 RowBox[{"v1", ",", "Il", ",", 
                  RowBox[{"Rs", "[", 
                   RowBox[{"[", "cell", "]"}], "]"}], ",", 
                  RowBox[{"thicknesses", "[", 
                   RowBox[{"[", "cell", "]"}], "]"}]}], "]"}], "-", 
                RowBox[{"JRnon", "[", 
                 RowBox[{"v1", ",", "Il", ",", 
                  RowBox[{"Rs", "[", 
                   RowBox[{"[", "cell", "]"}], "]"}], ",", 
                  RowBox[{"INR", "[", 
                   RowBox[{"[", "cell", "]"}], "]"}]}], "]"}], "-", 
                RowBox[{"Resistance", "[", 
                 RowBox[{"v1", ",", "Il", ",", 
                  RowBox[{"Rs", "[", 
                   RowBox[{"[", "cell", "]"}], "]"}], ",", 
                  RowBox[{"Rsh", "[", 
                   RowBox[{"[", "cell", "]"}], "]"}]}], "]"}]}]}], ",", 
              RowBox[{"{", 
               RowBox[{"Il", ",", "0"}], "}"}], ",", 
              RowBox[{"PrecisionGoal", "\[Rule]", "5"}], ",", 
              RowBox[{"MaxIterations", "\[Rule]", "10000"}]}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"v1", ",", "0", ",", 
           RowBox[{
            RowBox[{"SiBandgap", "[", "T", "]"}], "-", "0.3"}], ",", ".005"}],
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ivSi", "=", 
       RowBox[{"Interpolation", "[", 
        RowBox[{"dSi", ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "0"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Calculate", " ", "Voc"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"vocSi", "=", 
       RowBox[{
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{"ivSi", "[", "v", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"v", ",", 
            RowBox[{
             RowBox[{"SiBandgap", "[", "T", "]"}], "-", "0.4"}]}], "}"}]}], 
         "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Calculate", " ", "Jsc"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"jscSi", "=", 
       RowBox[{
        RowBox[{"ivSi", "[", "0", "]"}], "/", "10"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"mA", "/", 
        RowBox[{"cm", "^", "2"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Finding", " ", "the", " ", "maximum", " ", "power", " ", "conversion",
         " ", "efficiency", " ", "of", " ", "the", " ", "Si", " ", "cell"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"eff", "=", 
       RowBox[{"NMaximize", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"100", "*", 
            RowBox[{"ivSi", "[", "V", "]"}], " ", "*", 
            RowBox[{"V", "/", "totalIncomingPower"}]}], ",", 
           RowBox[{"0", "<", "V", "<", 
            RowBox[{
             RowBox[{"SiBandgap", "[", "T", "]"}], "-", "0.3"}]}]}], "}"}], 
         ",", "V"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"efficiency", "=", 
       RowBox[{"eff", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"efficiency", " ", "of", " ", "Si"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"maxvoltage", "=", 
       RowBox[{"V", "/.", 
        RowBox[{"eff", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"maxcurrent", "=", 
       RowBox[{"ivSi", "[", "maxvoltage", "]"}]}], " ", ";", 
      RowBox[{"(*", 
       RowBox[{"A", "/", 
        RowBox[{"m", "^", "2"}]}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"efficiency", " ", "of", " ", "LSC"}], ",", " ", 
        RowBox[{"relative", " ", "to", " ", "surface", " ", "area"}]}], " ", 
       "*)"}], "\n", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "power", " ", "into", " ", "the", " ", "LSC", " ", "vs", " ", "power",
          " ", "out", " ", "of", " ", "the", " ", "side", " ", "of", " ", 
         "LSC", " ", "BEFORE", " ", "impinging", " ", "onto", " ", "silicon", 
         " ", "cell", " ", "\n", "\t", "outputpower", " ", "LSC", " ", "is", 
         " ", "in", " ", 
         RowBox[{"W", "/", 
          RowBox[{"(", 
           RowBox[{"m", "^", "2"}], ")"}]}], " ", "as", " ", "is", " ", 
         "totalincidentpowerdirect"}], "+", "totalincidentpowerdiffuse"}], 
       "*)"}], " ", "\n", "\t", 
      RowBox[{"outputpowerlsc", " ", "=", " ", 
       RowBox[{"areaside", "*", "totaloutputLSCpower"}]}], ";", "\n", "\t", 
      RowBox[{"inputpower", " ", "=", " ", 
       RowBox[{"(", 
        RowBox[{"areasurface", "*", 
         RowBox[{"(", "totalIncomingPower", ")"}]}], ")"}]}], ";", "\n", "\t", 
      RowBox[{"lscPCE", " ", "=", " ", 
       RowBox[{"outputpowerlsc", "/", "inputpower"}]}], ";", "\n", "\n", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{
       "si", " ", "PCE", " ", "is", " ", "the", " ", "PCE", " ", "from", " ", 
        "the", " ", "LSC", " ", "output"}], " ", "*)"}], " ", "\n", "\t", 
      RowBox[{"siPCE", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"maxcurrent", "*", "maxvoltage"}], ")"}], "/", 
        "outputpowerlsc"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"efficiency", " ", "of", " ", "LSC"}], " ", "&"}], " ", 
         "Si", " ", "system"}], ",", " ", 
        RowBox[{"relative", " ", "to", " ", "surface", " ", "area"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"totalefficiency", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"maxcurrent", "*", "maxvoltage"}], ")"}], "/", 
        RowBox[{"(", "inputpower", ")"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "divide", " ", "by", " ", "1000", " ", "for", " ", "k", " ", "in", 
         " ", "kwh"}], " ", "-", " ", 
        RowBox[{
        "this", " ", "much", " ", "be", " ", "changed", " ", "if", " ", "you",
          " ", "change", " ", "the", " ", "step", " ", "size"}]}], " ", 
       "*)"}], " ", "\[IndentingNewLine]", 
      RowBox[{"kwh", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"maxcurrent", "*", "maxvoltage"}], ")"}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"15", "/", "60"}], ")"}], "/", "1000"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"month", ",", "pointinmonth", ",", 
         RowBox[{"ToString", "[", "date", "]"}], ",", "side", ",", 
         "totalefficiency", ",", "lscPCE", ",", "siPCE", ",", "kwh", ",", 
         "inputpower", ",", "outputpowerlsc", ",", "siPCE"}], "}"}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.821865937668693*^9, 3.821865990913678*^9}, {
   3.821866032481975*^9, 3.821866038434338*^9}, {3.821866108112162*^9, 
   3.8218661282289343`*^9}, {3.821866196973176*^9, 3.821866202414906*^9}, {
   3.821866366943048*^9, 3.8218663985215473`*^9}, {3.821866437160315*^9, 
   3.821866489691571*^9}, {3.821868463284491*^9, 3.821868466933424*^9}, {
   3.8218685140794067`*^9, 3.821868514344287*^9}, {3.821868547417694*^9, 
   3.821868561409864*^9}, {3.8218692902162237`*^9, 3.82186929085793*^9}, {
   3.8233483655781517`*^9, 3.82334836635783*^9}, {3.823348610655566*^9, 
   3.823348610887713*^9}, {3.82334942194936*^9, 3.823349425128237*^9}, {
   3.823349456463244*^9, 3.82334946888129*^9}, {3.8233500422444563`*^9, 
   3.823350045287322*^9}, {3.823350084990406*^9, 3.8233500881636047`*^9}, {
   3.82335012005548*^9, 3.823350199455173*^9}, {3.823350244635907*^9, 
   3.82335027360303*^9}, {3.823357307977928*^9, 3.8233573093488483`*^9}, {
   3.8233575315817757`*^9, 3.823357534239637*^9}, {3.823357656262514*^9, 
   3.8233576665792522`*^9}, {3.82335770286559*^9, 3.823357711712332*^9}, {
   3.823357785476775*^9, 3.8233577857598658`*^9}, {3.823360554442264*^9, 
   3.823360663791671*^9}, {3.823361992566346*^9, 3.8233620301297626`*^9}, {
   3.82336219211311*^9, 3.823362259510846*^9}, {3.823362742185708*^9, 
   3.823362751992782*^9}, 3.823363336863155*^9, {3.823937049927671*^9, 
   3.823937073156444*^9}, {3.823937211096423*^9, 3.8239372156941013`*^9}, {
   3.823937256111863*^9, 3.823937275032647*^9}, {3.823944797016436*^9, 
   3.823944823566257*^9}, {3.870593093241157*^9, 3.8705931099567413`*^9}, {
   3.8705970774892073`*^9, 3.8705970837640333`*^9}, {3.87059952323206*^9, 
   3.870599602100678*^9}, {3.870599637988717*^9, 3.870599671223259*^9}, 
   3.87060017574463*^9, {3.8706070389670267`*^9, 3.870607140787504*^9}, {
   3.870607202519389*^9, 3.870607205274375*^9}, {3.870607303245737*^9, 
   3.870607319223364*^9}, {3.870607548665278*^9, 3.870607561500255*^9}, {
   3.8706080370513163`*^9, 3.870608039289289*^9}, {3.870614451942977*^9, 
   3.870614499683477*^9}, {3.870614530366506*^9, 3.870614599280471*^9}, {
   3.8706146380088053`*^9, 3.870614655765411*^9}, {3.870614756961917*^9, 
   3.8706147615335503`*^9}, {3.870615032164701*^9, 3.870615107609127*^9}, {
   3.870615157212616*^9, 3.870615237532995*^9}, {3.8706177560430107`*^9, 
   3.870617770792493*^9}, 3.8706759387303*^9, {3.8706764943584633`*^9, 
   3.870676499068502*^9}, {3.870676585062193*^9, 3.870676608020831*^9}, 
   3.870676698576469*^9, {3.870676730347612*^9, 3.870676736451786*^9}, {
   3.870676768061406*^9, 3.870676783084642*^9}, {3.870676933550304*^9, 
   3.870676943490603*^9}, {3.870677180378026*^9, 3.870677191433837*^9}, {
   3.870677556683116*^9, 3.870677649757018*^9}, {3.8706776841852627`*^9, 
   3.8706776942919188`*^9}, {3.8708668325143547`*^9, 3.87086683398497*^9}, {
   3.870867909367857*^9, 3.870867961483971*^9}, {3.8708692095796547`*^9, 
   3.870869214481737*^9}, 3.870874365418171*^9, 3.871013316491095*^9, {
   3.873174853727128*^9, 3.873174854622102*^9}, {3.8731759806765757`*^9, 
   3.873175980947074*^9}, 
   3.905611419341628*^9},ExpressionUUID->"1c1a18c1-4fd7-4503-be40-\
3acc1b1b193e"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{"90", "-", 
       RowBox[{"Abs", "[", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Round", "[", 
               RowBox[{"realAngleAtLSC", "[", 
                RowBox[{"alt", ",", "azi"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"alt", ",", "1", ",", "180", ",", 
                RowBox[{"180", "/", "10"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"azi", ",", "1", ",", "359", ",", 
                RowBox[{"360", "/", "20"}]}], "}"}]}], "]"}], ",", "1"}], 
           "]"}], "-", "90"}], ")"}], "]"}]}], ",", 
      RowBox[{"Joined", "\[Rule]", "True"}], ",", 
      RowBox[{"GridLines", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", " ", 
         RowBox[{"{", "90", "}"}]}], "}"}]}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "180"}]}], "]"}], ",", 
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Round", "[", 
           RowBox[{"realAngleAtLSC", "[", 
            RowBox[{"alt", ",", "azi"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"alt", ",", "1", ",", "180", ",", 
            RowBox[{"180", "/", "10"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"azi", ",", "1", ",", "359", ",", 
            RowBox[{"360", "/", "20"}]}], "}"}]}], "]"}], ",", "1"}], "]"}], 
      ",", 
      RowBox[{"Joined", "\[Rule]", "True"}], ",", 
      RowBox[{"GridLines", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", " ", 
         RowBox[{"{", "90", "}"}]}], "}"}]}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}]}], "]"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.8239409798571*^9, 3.823940982179854*^9}, {
  3.823941508249332*^9, 3.82394151077768*^9}, {3.823942441528988*^9, 
  3.8239424688439693`*^9}, {3.8239443146220217`*^9, 3.823944359212593*^9}, {
  3.870592879353013*^9, 
  3.87059288160548*^9}},ExpressionUUID->"5b66c3e4-7ddf-42d6-9a49-\
62897cbdea4b"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"(*", " ", 
    RowBox[{"Run", " ", "the", " ", "Model"}], "   ", "*)"}], " "}], 
  "Chapter"]], "Input",
 CellChangeTimes->{{3.8052697618338346`*^9, 3.8052697749286013`*^9}, {
  3.8052711192138653`*^9, 
  3.805271119504034*^9}},ExpressionUUID->"635b829d-24e8-440a-9171-\
746c78944713"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.870614482068516*^9},ExpressionUUID->"df174c6e-1191-4de2-8e10-\
90c3b51ff31c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"this", " ", "outputs", " ", "for", " ", "all", " ", "sides"}], 
    ",", " ", 
    RowBox[{
    "no", " ", "need", " ", "to", " ", "do", " ", "it", " ", "individually", 
     " ", "like", " ", "the", " ", "colorado", " ", "function"}]}], " ", 
   "*)"}], " ", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "the", " ", "lad", " ", "is", " ", "in", " ", "10", " ", "second", " ", 
     "increments"}], ",", " ", 
    RowBox[{"lets", " ", "do", " ", "15", " ", "mins", " ", "steps", " ", 
     RowBox[{"(", 
      RowBox[{
      "also", " ", "efficiencies", " ", "are", " ", "matched", " ", "to", " ",
        "that"}], " ", ")"}]}], ",", " ", "hence"}], "  ", "*)"}], " ", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"24", " ", "hours"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"1440", " ", "minutes"}], " ", "=", " ", 
     RowBox[{"86400", " ", "seconds"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "8640", " ", "10", " ", "second", " ", "increments", " ", "seconds", " ", 
    "in", " ", "day"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"15", " ", "minutes"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"15", "*", "60"}], " ", "=", " ", 
      RowBox[{"900", " ", "seconds"}]}]}], ",", " ", 
    RowBox[{
    "so", " ", "move", " ", "in", " ", "steps", " ", "of", " ", "90", " ", 
     "to", " ", "get", " ", "15", " ", "minutes", " ", "resolution"}]}], "  ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"areafront", " ", "=", " ", 
     RowBox[{"0.1", "*", "0.1"}]}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"areaside", " ", "=", " ", 
     RowBox[{"10", "*", 
      RowBox[{"1", "/", "3"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "2"}], ")"}]}], ")"}], "^", "2"}]}]}], " ", ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"0.1", "*", "0.00333333"}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"string", " ", "=", " ", 
        RowBox[{"\"\<./results_amolf/\>\"", "<>", 
         RowBox[{"ToString", "[", "monthvalue", "]"}], "<>", "\"\<_\>\"", "<>", 
         RowBox[{"ToString", "[", "time", "]"}], "<>", "\"\<.csv\>\""}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"resulttoexport", " ", "=", " ", 
        RowBox[{"sicell", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"10", "*", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"-", "2"}], ")"}]}]}], ")"}], "^", "2"}], ",", 
          RowBox[{"10", "*", 
           RowBox[{"1", "/", "3"}], "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"-", "2"}], ")"}]}], ")"}], "^", "2"}]}], ",", "1", 
          " ", 
          RowBox[{"(*", " ", 
           RowBox[{"not", " ", "needed"}], "*)"}], ",", "monthvalue", " ", 
          RowBox[{"(*", " ", 
           RowBox[{"month", " ", "value"}], "*)"}], ",", "time"}], 
         RowBox[{"(*", " ", 
          RowBox[{"point", " ", "in", " ", "month"}], " ", "*)"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"string", ",", "resulttoexport", ",", "\"\<CSV\>\""}], "]"}], 
       ";"}], ",", 
      RowBox[{"{", 
       RowBox[{"time", ",", "timepoint", ",", 
        RowBox[{"timepoint", "+", "8640"}], ",", "90"}], "}"}]}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.870596864709319*^9, 3.870596865995969*^9}, {
   3.870596948644837*^9, 3.8705969671411133`*^9}, {3.870597296342312*^9, 
   3.8705972994450693`*^9}, {3.8705974994100857`*^9, 3.870597508370665*^9}, {
   3.870597832010539*^9, 3.870597862008194*^9}, {3.8705979739359837`*^9, 
   3.870597977830847*^9}, {3.870607060428199*^9, 3.87060706261719*^9}, {
   3.870677739478938*^9, 3.870677794075122*^9}, {3.870677854048892*^9, 
   3.870677924843171*^9}, {3.8708743964454737`*^9, 3.870874448360531*^9}, 
   3.870875219858822*^9, {3.870877804844654*^9, 3.870877808532156*^9}, {
   3.870962267493396*^9, 3.8709623225627127`*^9}, {3.870962356799541*^9, 
   3.870962360167934*^9}, {3.8709624008439207`*^9, 3.8709624053668222`*^9}, 
   3.8709633367492332`*^9, {3.871014241606123*^9, 3.8710142548041363`*^9}, {
   3.87101490259485*^9, 
   3.8710149163931437`*^9}},ExpressionUUID->"05e47718-4103-4c19-a9ac-\
766ddd0a2922"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Tue 1 Jan 2019 00:00:03\"\>"], "Print",
 CellChangeTimes->{3.870962410923427*^9, 3.8709624612566433`*^9, 
  3.8709625132322197`*^9, 3.8709626399952374`*^9, 3.870962695719493*^9},
 CellLabel->
  "During evaluation of \
In[190]:=",ExpressionUUID->"1eb59bda-a107-4c50-ac78-3d70e70b1c6a"],

Cell[BoxData["\<\"jg:  17.29\"\>"], "Print",
 CellChangeTimes->{3.870962410923427*^9, 3.8709624612566433`*^9, 
  3.8709625132322197`*^9, 3.8709626399952374`*^9, 3.870963128588603*^9},
 CellLabel->
  "During evaluation of \
In[190]:=",ExpressionUUID->"48f11e3b-f338-4439-905f-beac025879a6"],

Cell[BoxData["\<\"incoming Power:  26.1159in W/m^2\"\>"], "Print",
 CellChangeTimes->{3.870962410923427*^9, 3.8709624612566433`*^9, 
  3.8709625132322197`*^9, 3.8709626399952374`*^9, 3.8709631285905952`*^9},
 CellLabel->
  "During evaluation of \
In[190]:=",ExpressionUUID->"030ca690-e022-4a60-9ad7-466e33f6ea27"],

Cell[BoxData["\<\"totaloutputLSCpower:  22.6658in W/m^2\"\>"], "Print",
 CellChangeTimes->{3.870962410923427*^9, 3.8709624612566433`*^9, 
  3.8709625132322197`*^9, 3.8709626399952374`*^9, 3.870963128591745*^9},
 CellLabel->
  "During evaluation of \
In[190]:=",ExpressionUUID->"81c3e94f-90a1-465f-846a-badaa105fc4c"]
}, Open  ]],

Cell[BoxData[
 TemplateBox[{
  "FindRoot", "jsing", 
   "\"Encountered a singular Jacobian at the point \
\\!\\(\\*RowBox[{\\\"{\\\", \\\"v\\\", \\\"}\\\"}]\\) = \
\\!\\(\\*RowBox[{\\\"{\\\", \\\"0.7249894675988865`\\\", \\\"}\\\"}]\\). Try \
perturbing the initial point(s).\"", 2, 190, 39, 29218734151494569495, 
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.870962411145789*^9, 3.870962461282975*^9, 
  3.870962513256736*^9, 3.87096264017725*^9, 3.8709631287282133`*^9},
 CellLabel->
  "During evaluation of \
In[190]:=",ExpressionUUID->"97f3f322-25d1-4668-a8e9-e6c999bdfd62"],

Cell[BoxData["\<\"Tue 1 Jan 2019 00:15:03\"\>"], "Print",
 CellChangeTimes->{3.870962410923427*^9, 3.8709624612566433`*^9, 
  3.8709625132322197`*^9, 3.8709626399952374`*^9, 3.870963130315271*^9},
 CellLabel->
  "During evaluation of \
In[190]:=",ExpressionUUID->"cf6af301-5f21-4e36-b70c-3a6f871b825f"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.870962414660375*^9, 3.87096246360813*^9, 
  3.870962516313463*^9, 3.870962646438631*^9, 3.8709633308997717`*^9},
 CellLabel->
  "Out[190]=",ExpressionUUID->"3dc00d23-903a-46b5-ba55-afe8a28149af"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.870863760549127*^9, 3.8708637621167393`*^9}, 
   3.870874463429839*^9, {3.870874510825918*^9, 3.870874519136717*^9}, {
   3.870875186248611*^9, 
   3.870875218000532*^9}},ExpressionUUID->"25e6cdae-4f2a-451b-8ef1-\
dba4b388ef7b"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Geneate", " ", ".", "xls"}], " ", "script"}], "   ", "*)"}], 
   " "}], "Chapter"]], "Input",
 CellChangeTimes->{{3.805268608854138*^9, 3.8052686106660233`*^9}, {
  3.805268670496414*^9, 3.8052686765704536`*^9}, {3.805269004512122*^9, 
  3.8052690104407797`*^9}, {3.8052690409277143`*^9, 3.8052690446629057`*^9}, {
  3.8052690849163923`*^9, 3.805269108618724*^9}, {3.805269164071608*^9, 
  3.805269173915454*^9}, {3.8052692072734547`*^9, 3.805269211053802*^9}, {
  3.8052693814114227`*^9, 3.80526938345868*^9}, {3.805269738784289*^9, 
  3.805269739468132*^9}, {3.805271123286791*^9, 3.805271124107012*^9}, {
  3.805272337514658*^9, 
  3.805272343013887*^9}},ExpressionUUID->"aa451b02-0ee5-4fc7-8103-\
724a7424ccfa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Delete", " ", "all", " ", "output", " ", "and", " ", "quit", " ", "kernl",
     " ", "before", " ", "running", " ", "this"}], " ", "*)"}], " ", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nb", "=", 
     RowBox[{"InputNotebook", "[", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"fn", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", "\"\<analysis_amolf.wls\>\"", "}"}], "]"}]}], ";"}], "\n", 
   RowBox[{"FrontEndExecute", "[", 
    RowBox[{"FrontEndToken", "[", 
     RowBox[{"nb", ",", "\"\<Save\>\"", ",", 
      RowBox[{"{", 
       RowBox[{"fn", ",", "\"\<Text\>\""}], "}"}]}], "]"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8052766835555162`*^9, 3.8052766864620733`*^9}, {
  3.8708778216285133`*^9, 
  3.870877822282695*^9}},ExpressionUUID->"e9030a35-e8fd-41c4-b724-\
40203743e4c1"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"(*", " ", 
    RowBox[{"Import", " ", "the", " ", "Results"}], "   ", "*)"}], " "}], 
  "Chapter"]], "Input",
 CellChangeTimes->{{3.805268608854138*^9, 3.8052686106660233`*^9}, {
  3.805268670496414*^9, 3.8052686765704536`*^9}, {3.805269004512122*^9, 
  3.8052690104407797`*^9}, {3.8052690409277143`*^9, 3.8052690446629057`*^9}, {
  3.8052690849163923`*^9, 3.805269108618724*^9}, {3.805269164071608*^9, 
  3.805269173915454*^9}, {3.8052692072734547`*^9, 3.805269211053802*^9}, {
  3.8052693814114227`*^9, 3.80526938345868*^9}, {3.805269738784289*^9, 
  3.805269739468132*^9}, {3.805271123286791*^9, 3.805271124107012*^9}, {
  3.805272466405912*^9, 
  3.805272471061748*^9}},ExpressionUUID->"c5e3910e-2f11-499d-b99d-\
3e6d517c72ea"]
},
Evaluator->"Local",
WindowSize->{960, 983},
WindowMargins->{{Automatic, -1920}, {10, Automatic}},
FrontEndVersion->"13.1 for Mac OS X ARM (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"cb8ef865-2e9d-4731-9103-e1d538984759"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[400, 13, 1482, 35, 208, "Code",ExpressionUUID->"e1ccfd5e-5827-4fc6-b53b-90d42af0aee2",
 InitializationCell->False],
Cell[CellGroupData[{
Cell[1907, 52, 154, 3, 30, "Input",ExpressionUUID->"22ca08d9-1cb1-4de2-aaf6-ee0c5a7b543c"],
Cell[2064, 57, 372, 7, 56, "Output",ExpressionUUID->"07208e8c-7639-42ee-84d5-ad0f7bad33a3"]
}, Open  ]],
Cell[2451, 67, 316, 7, 56, "Input",ExpressionUUID->"c6084de3-b099-4537-b9df-fcfb1e880688"],
Cell[2770, 76, 957, 23, 199, "Input",ExpressionUUID->"43462baf-1c9b-42b7-8f71-e97b77586197"],
Cell[3730, 101, 444, 11, 56, "Input",ExpressionUUID->"d3025d4b-3951-4e00-bee5-185e79cdbba2",
 Evaluatable->False],
Cell[4177, 114, 3424, 80, 388, "Input",ExpressionUUID->"94fd9888-9688-4021-a4b9-f173e1fe4269"],
Cell[7604, 196, 513, 12, 56, "Input",ExpressionUUID->"eff5ed55-8f92-4d10-b4ef-af36e67586c6",
 Evaluatable->False],
Cell[8120, 210, 566, 13, 56, "Input",ExpressionUUID->"f96a784c-24d0-4e8d-9c17-5174a10f4532",
 Evaluatable->False],
Cell[8689, 225, 1909, 38, 199, "Input",ExpressionUUID->"6edd1b18-3690-4b26-a3c0-f03267a18b57"],
Cell[CellGroupData[{
Cell[10623, 267, 226, 4, 30, "Input",ExpressionUUID->"c124b16d-2a10-4cc5-8638-a632d58d2367"],
Cell[10852, 273, 259, 6, 48, "Output",ExpressionUUID->"a6fbf560-9cf5-4e9d-abdc-4fff7ff70cef"]
}, Open  ]],
Cell[11126, 282, 152, 3, 30, "Input",ExpressionUUID->"60771c55-47d6-4966-ae35-f4113a2030fb"],
Cell[CellGroupData[{
Cell[11303, 289, 6779, 171, 577, "Input",ExpressionUUID->"d809e300-63bf-4bb6-9df0-3e60669dd028"],
Cell[18085, 462, 259, 5, 24, "Print",ExpressionUUID->"e902c1e9-34ae-46cf-bab7-74c453cca7c6"]
}, Open  ]],
Cell[18359, 470, 355, 8, 56, "Input",ExpressionUUID->"f12be99d-d56b-4a4d-a005-309f597eb967"],
Cell[18717, 480, 267, 5, 30, "Input",ExpressionUUID->"dcf48d8e-17ff-4c52-8523-185241259ec0"],
Cell[18987, 487, 15036, 396, 987, "Code",ExpressionUUID->"46b97799-db96-4493-99ff-5d1ca9974231",
 InitializationCell->False],
Cell[34026, 885, 7209, 211, 453, "Input",ExpressionUUID->"5cc077cf-512d-4587-8847-b8fe589cbce3"],
Cell[41238, 1098, 362, 7, 56, "Input",ExpressionUUID->"ed1d4fa4-a95e-4ec4-b68e-882aaa37b43d"],
Cell[41603, 1107, 2554, 82, 241, "Input",ExpressionUUID->"ad81bff5-1414-4400-b00c-49cc0a862850"],
Cell[44160, 1191, 467, 9, 56, "Input",ExpressionUUID->"0a5ff604-4aa0-4258-bfb8-57c251bae1fc"],
Cell[44630, 1202, 4217, 130, 157, "Input",ExpressionUUID->"f4c3fe4a-8d0f-4c15-8fa3-4ac4fae8ca64"],
Cell[48850, 1334, 505, 10, 56, "Input",ExpressionUUID->"0ca3ad0f-daa5-413d-abe5-fb17d965280a"],
Cell[49358, 1346, 4499, 120, 388, "Input",ExpressionUUID->"42558fd6-369f-4530-af85-719e3dc10f1f"],
Cell[53860, 1468, 499, 10, 56, "Input",ExpressionUUID->"45b4b28a-9fdd-471b-8345-a30d72ced460"],
Cell[54362, 1480, 3902, 114, 304, "Input",ExpressionUUID->"91cfc03c-e6a4-435f-a752-3465ea327270"],
Cell[58267, 1596, 544, 11, 56, "Input",ExpressionUUID->"869e268f-131e-4248-b324-24e0979d96e0"],
Cell[58814, 1609, 4861, 131, 367, "Input",ExpressionUUID->"839ad805-4b69-4644-a34f-ec00791d8948"],
Cell[63678, 1742, 596, 11, 56, "Input",ExpressionUUID->"03e6511b-1e3e-4cab-9917-a8cb0fbbbe20"],
Cell[64277, 1755, 934, 26, 115, "Input",ExpressionUUID->"2d4afeb1-d748-47b3-8630-54199d87069a"],
Cell[65214, 1783, 312, 8, 56, "Input",ExpressionUUID->"ec7016f8-ec00-4c4f-b230-ecfbc807ede5"],
Cell[65529, 1793, 13713, 308, 1107, "Input",ExpressionUUID->"af865f47-6fe3-4ae6-b670-4dd7f2a2974e"],
Cell[79245, 2103, 18167, 380, 1690, "Input",ExpressionUUID->"1c1a18c1-4fd7-4503-be40-3acc1b1b193e"],
Cell[97415, 2485, 2361, 61, 136, "Input",ExpressionUUID->"5b66c3e4-7ddf-42d6-9a49-62897cbdea4b"],
Cell[99779, 2548, 333, 9, 56, "Input",ExpressionUUID->"635b829d-24e8-440a-9171-746c78944713"],
Cell[100115, 2559, 128, 3, 30, "Input",ExpressionUUID->"df174c6e-1191-4de2-8e10-90c3b51ff31c"],
Cell[CellGroupData[{
Cell[100268, 2566, 4679, 111, 304, "Input",ExpressionUUID->"05e47718-4103-4c19-a9ac-766ddd0a2922"],
Cell[CellGroupData[{
Cell[104972, 2681, 302, 5, 24, "Print",ExpressionUUID->"1eb59bda-a107-4c50-ac78-3d70e70b1c6a"],
Cell[105277, 2688, 289, 5, 24, "Print",ExpressionUUID->"48f11e3b-f338-4439-905f-beac025879a6"],
Cell[105569, 2695, 313, 5, 24, "Print",ExpressionUUID->"030ca690-e022-4a60-9ad7-466e33f6ea27"],
Cell[105885, 2702, 316, 5, 24, "Print",ExpressionUUID->"81c3e94f-90a1-465f-846a-badaa105fc4c"]
}, Open  ]],
Cell[106216, 2710, 608, 13, 28, "Message",ExpressionUUID->"97f3f322-25d1-4668-a8e9-e6c999bdfd62"],
Cell[106827, 2725, 302, 5, 24, "Print",ExpressionUUID->"cf6af301-5f21-4e36-b70c-3a6f871b825f"],
Cell[107132, 2732, 252, 4, 34, "Output",ExpressionUUID->"3dc00d23-903a-46b5-ba55-afe8a28149af"]
}, Open  ]],
Cell[107399, 2739, 277, 5, 30, "Input",ExpressionUUID->"25e6cdae-4f2a-451b-8ef1-dba4b388ef7b"],
Cell[107679, 2746, 801, 16, 56, "Input",ExpressionUUID->"aa451b02-0ee5-4fc7-8103-724a7424ccfa"],
Cell[108483, 2764, 914, 24, 115, "Input",ExpressionUUID->"e9030a35-e8fd-41c4-b724-40203743e4c1"],
Cell[109400, 2790, 779, 15, 56, "Input",ExpressionUUID->"c5e3910e-2f11-499d-b99d-3e6d517c72ea"]
}
]
*)

